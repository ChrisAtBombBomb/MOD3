/**
*
*   Classy.js
*   @version: 0.5
*
*   Object-Oriented mini-framework for JavaScript
*   https://github.com/foo123/classy.js
*
**/!function(e,t,n,r,o){var i="undefined"!=typeof global&&"[object global]"=={}.toString.call(global)?1:0,l=i||"undefined"==typeof navigator?0:1,a="function"==typeof importScripts&&navigator instanceof WorkerNavigator?1:0,u=Array,c=u.prototype,f=function(){var e=null;if(i)return e=__filename,{path:__dirname,file:__filename};if(a)e=self.location.href;else if(l){var t;(t=document.getElementsByTagName("script"))&&t.length&&(e=t[t.length-1].src)}return e?{path:e.split("/").slice(0,-1).join("/"),file:e}:{path:null,file:null}},s=f(),p=function(e,t){if(i)return t;if("."==t.charAt(0)){e=e.split("/"),t=t.split("/");var n,r=0,o=0,l=t.length,a=e.length;for(n=0;l>n;n++)if(/^\.\./.test(t[n]))r++,o++;else{if(!/^\./.test(t[n]))break;o++}r=r>=a?0:a-r,t=e.slice(0,r).concat(t.slice(o)).join("/")}return t};n=n?[].concat(n):[];var b,d,y,g=n.length,v=new u(g),m=new u(g),h=new u(g),w=new u(g);for(b=0;g>b;b++)v[b]=n[b][0],m[b]=n[b][1],h[b]=/\.js$/i.test(m[b])?p(s.path,m[b]):p(s.path,m[b]+".js");if("object"==typeof module&&module.exports){if(o===module.exports[t]){for(b=0;g>b;b++)w[b]=module.exports[v[b]]||require(h[b])[v[b]];d=r.apply(e,w),module.exports[t]=d||1}}else if("function"==typeof define&&define.amd)define(["exports"].concat(m),function(n){if(o===n[t]){for(var i=c.slice.call(arguments,1),l=i.length,a=0;l>a;a++)w[a]=n[v[a]]||i[a];d=r.apply(e,w),n[t]=d||1}});else if(a){for(b=0;g>b;b++)self[v[b]]||importScripts(h[b]),w[b]=self[v[b]];d=r.apply(e,w),self[t]=d||1}else if(o===e[t]){var j=function(e,t){y=y||document.getElementsByTagName("head")[0];var n=0,r=document.createElement("script");r.type="text/javascript",r.language="javascript",r.src=e,r.onload=r.onreadystatechange=function(){n||r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(n=1,r.onload=r.onreadystatechange=null,y.removeChild(r),r=null,t&&t())},y.appendChild(r)},E=function(t,n,r){e[t]?r():j(n,r)},x=function(n){return function(){g>n&&(w[n]=e[v[n]]),++n<g?E(v[n],h[n],x(n)):(d=r.apply(e,w),e[t]=d||1)}};g?E(v[0],h[0],x(0)):(d=r.apply(e,w),e[t]=d||1)}}(this,"Classy",null,function(){var e={};return function(e,t){var n=function(e,t,n){this.v=e||null,this.prev=t||null,this.next=n||null};n.prototype={constructor:n,v:null,prev:null,next:null};var r=Array.prototype,o=Object.prototype,i=Function.prototype,l=i.call.bind(r.slice),a=i.call.bind(o.toString),u=i.call.bind(o.hasOwnProperty),c=i.call.bind(o.propertyIsEnumerable),f=Object.keys,s=Object.defineProperty,p=2,b=3,d=4,y=8,g=9,v=16,m=32,h=64,w=128,j=256,E=512,x=1024,_=function(e){var t=typeof e,n=a(e);return"undefined"===t?E:"number"===t||e instanceof Number?isNaN(e)?b:p:null===e?j:!0===e||!1===e?d:e&&("string"===t||e instanceof String)?1===e.length?g:y:e&&("[object Array]"===n||e instanceof Array)?v:e&&("[object RegExp]"===n||e instanceof RegExp)?w:e&&("function"===t&&"[object Function]"===n||e instanceof Function)?h:e&&"[object Object]"===n?m:x},O=function(e,t){var n,r=t.length,o=[].concat(e);for(n=0;r>n;n++)o.indexOf(t[n])>-1||o.push(t[n]);return o},N=function(e,t){if(m!==_(e))throw new TypeError("bad desc");var n={};if(u(e,"enumerable")&&(n.enumerable=!!t.enumerable),u(e,"configurable")&&(n.configurable=!!t.configurable),u(e,"value")&&(n.value=t.value),u(e,"writable")&&(n.writable=!!e.writable),u(e,"get")){var r=e.get;if(h!==_(r)&&"undefined"!==r)throw new TypeError("bad get");n.get=r}if(u(e,"set")){var o=e.set;if(h!==_(o)&&"undefined"!==o)throw new TypeError("bad set");n.set=o}if(("get"in n||"set"in n)&&("value"in n||"writable"in n))throw new TypeError("identity-confused descriptor");return n},T=Object.defineProperties||function(e,t){if("object"!=typeof e||null===e)throw new TypeError("bad obj");t=Object(t);for(var n=f(t),r=[],o=0;o<n.length;o++)r.push([n[o],N(t[n[o]],e)]);for(var o=0;o<r.length;o++)s(e,r[o][0],r[o][1]);return e},S=Object.create||function(e,t){var n,r=function(){};return r.prototype=e,n=new r,n.__proto__=e,"object"==typeof t&&T(n,t),n},A=function(e){var t=new n(e);return function(e){if(e&&t&&t.v){var r,o=this;if(e="constructor"==e?t.v:t.v.prototype[e])return t=new n(t.v.$super,t),r=e.apply(o,l(arguments,1)),t=t.prev,r}}},C=function(){var e,t,n,r,o,i,a,f=l(arguments);for(t=f.shift()||{},e=f.length,i=0;e>i;i++)if(n=f[i],m===_(n))for(o in n)u(n,o)&&c(n,o)&&(r=n[o],a=_(r),t[o]=p&a?0+r:(y|v)&a?r.slice(0):r);return t},R=function(e,n){e=e||Object,n=n||{};var r,o,i,l,a,c,s,b,d=null,g=e.$static||null;if(u(n,"constructor")?o=n.constructor:(r=function(){},n.constructor=o=r),u(n,"__static__")&&(d=n.__static__,delete n.__static__,g=O(g||[],f(d))),o.prototype=S(e.prototype),o.prototype=C(o.prototype,n),T(o.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0},$class:{value:o,enumerable:!1,writable:!0,configurable:!0},$super:{value:A(e),enumerable:!1,writable:!0,configurable:!0}}),T(o,{$super:{value:e,enumerable:!1,writable:!0,configurable:!0},$static:{value:g,enumerable:!1,writable:!0,configurable:!0}}),g){for(l=g.length,a={},i=0;l>i;i++)c=g[i],s=null,d&&t!==d[c]?s=d[c]:t!==e[c]&&(b=_(e[c]),s=m===b?C(null,e[c]):(y|v)&b?e[c].slice(0):p&b?0+e[c]:e[c]),a[c]={value:s,enumerable:!1,writable:!0,configurable:!0};T(o,a)}return o},I=Mixin=C,M=function(){var e=l(arguments),t=e.length,n=null;if(t>=2){var r=_(e[0]);r=h===r?{Extends:e[0]}:m===r?e[0]:{Extends:Object};var o,i,a=e[1]||{},u={},c=r.Extends||r.extends||Object,f=r.Implements||r.implements,s=r.Mixin||r.mixin;if(f=f?[].concat(f):null,s=s?[].concat(s):null)for(o=0,i=s.length;i>o;o++)s[o].prototype&&(u=Mixin(u,s[o].prototype));if(f)for(o=0,i=f.length;i>o;o++)f[o].prototype&&(u=I(u,f[o].prototype));n=R(c,C(u,a))}else n=R(Object,e[0]);return n};e.Classy={VERSION:"0.5",T:{UNDEFINED:E,NULL:j,BOOLEAN:d,STRING:y,NUMBER:p,NAN:b,FUNCTION:h,REGEXP:w,ARRAY:v,OBJECT:m},Type:_,Create:S,Merge:C,Implements:I,Mixin:Mixin,Extends:R,Static:function(e){return e},Class:M}}(e),e.Classy});
/**
*
*   MOD3.js
*   @version: 0.3.5
*   @dependencies: Classy.js
*
*   MOD3 3D Modifier Library for JavaScript 
*   port of AS3DMod ActionScript3 library (http://code.google.com/p/as3dmod/)
*   https://github.com/foo123/MOD3
*
**/!function(t,e,s,i,n){s=s?[].concat(s):[];var r,h,o=Array,u=o.prototype,a=s.length,c=new o(a);if("object"==typeof module&&module.exports){if(n===module.exports[e]){for(r=0;a>r;r++)c[r]=module.exports[s[r][0]]||require(s[r][1])[s[r][0]];h=i.apply(t,c),module.exports[e]=h||1}}else if("function"==typeof define&&define.amd)define(["exports"].concat(s.map(function(t){return t[1]})),function(r){if(n===r[e]){var o,a=u.slice.call(arguments,1),l=a.length;for(o=0;l>o;o++)c[o]=r[s[o][0]]||a[o];h=i.apply(t,c),r[e]=h||1}});else if(n===t[e]){for(r=0;a>r;r++)c[r]=t[s[r][0]];h=i.apply(t,c),t[e]=h||1}}(this,"MOD3",[["Classy","./classy"]],function(t){var e=e||{VERSION:"0.3.5",Class:t.Class,StaticClass:t.Static};return function(t){t.Constants={PI:Math.PI,invPI:1/Math.PI,halfPI:.5*Math.PI,doublePI:2*Math.PI,toRad:Math.PI/180,toDeg:180/Math.PI},t.ModConstant={NONE:0,LEFT:-1,RIGHT:1,X:1,Y:2,Z:4,Xi:0,Yi:1,Zi:2},t.Array32F="undefined"!=typeof Float32Array?Float32Array:Array,t.Array64F="undefined"!=typeof Float64Array?Float64Array:Array,t.Array8I="undefined"!=typeof Int8Array?Int8Array:Array,t.Array16I="undefined"!=typeof Int16Array?Int16Array:Array,t.Array32I="undefined"!=typeof Int32Array?Int32Array:Array,t.Array8U="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Array16U="undefined"!=typeof Uint16Array?Uint16Array:Array,t.Array32U="undefined"!=typeof Uint32Array?Uint32Array:Array,t.VecArray=t.Array32F}(e),function(t,e){var s,i=t.Constants.toRad,n=t.Constants.toDeg,r=Math.min,h=Math.max,o=Math.pow,u=Math.round,a=Math.florr,c=Math.ceil,l=t.XMath=t.StaticClass({normalize:function(t,e,i){var n,r=e-t;return n=0===r?1:s(0,1,(i-t)/e)},toRange:function(t,e,s){var i,n=e-t;return i=0===n?0:t+(e-t)*s},inRange:function(t,s,i,n){return n===e&&(n=!1),n?i>=t&&s>=i:i>t&&s>i},sign:function(t,s){return s===e&&(s=0),0==t?s:t>0?1:-1},trim:function(t,e,s){return r(e,h(t,s))},wrap:function(t,e,s){var i=e-t;return t>s?s+i:s>=e?s-i:s},degToRad:function(t){return t*i},radToDeg:function(t){return t*n},presicion:function(t,e){var s=o(10,e);return u(t*s)/s},uceil:function(t){return 0>t?a(t):c(t)}});s=l.clamp=l.trim}(e),function(t,e){var s=t.XMath.normalize,i=t.XMath.toRange,n=t.XMath.trim;t.Range=t.Class(Object,{constructor:function(t,s){this.start=0,this.end=1,t!==e&&(this.start=t),s!==e&&(this.end=s)},start:0,end:1,dispose:function(){return this.start=null,this.end=null,this},getSize:function(){return this.end-this.start},move:function(t){this.start+=t,this.end+=t},isIn:function(t){return t>=this.start&&t<=this.end},normalize:function(t){return s(this.start,this.end,t)},toRange:function(t){return i(this.start,this.end,t)},trim:function(t){return n(this.start,this.end,t)},interpolate:function(t,e){return i(this.start,this.end,e.normalize(t))},toString:function(){return"["+this.start+" - "+this.end+"]"}})}(e),function(t,e){var s=Math.sin,i=Math.abs;t.Phase=t.Class(Object,{constructor:function(t){this.value=0,t!==e&&(this.value=t)},value:0,dispose:function(){return this.value=null,this},getPhasedValue:function(){return s(this.value)},getAbsPhasedValue:function(){return i(s(this.value))},getNormValue:function(){return.5*(s(this.value)+1)}})}(e),function(t,e){var s=t.Point=t.Class(Object,{constructor:function(t,s){this.x=t===e?0:t,this.y=s===e?0:s},x:0,y:0,dispose:function(){return this.x=null,this.y=null,this},clone:function(){return new s(this.x,this.y)}})}(e),function(t,e){var s=Math.sin,i=Math.cos,n=t.Point,r=t.Matrix=t.Class(Object,{constructor:function(t,s,i,n){this.m11=t===e?1:t,this.m12=s===e?0:s,this.m21=i===e?0:i,this.m22=n===e?1:n},m11:1,m12:0,m21:0,m22:1,dispose:function(){return this.m11=null,this.m12=null,this.m21=null,this.m22=null,this},reset:function(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this},rotate:function(t){var e=i(t),n=s(t);return this.m11=e,this.m12=-n,this.m21=n,this.m22=e,this},scale:function(t,s){return this.m12=0,this.m21=0,this.m11=1,this.m22=1,t!==e&&(this.m11=t,this.m22=t),s!==e&&(this.m22=s),this},multiply:function(t){var e=this.m11,s=this.m12,i=this.m21,n=this.m22,r=t.m11,h=t.m12,o=t.m21,u=t.m22;return this.m11=e*r+s*o,this.m12=e*h+s*u,this.m21=i*r+n*o,this.m22=i*h+n*u,this},transformPoint:function(t){var e=t.x,s=t.y,i=this.m11*e+this.m12*s,r=this.m21*e+this.m22*s;return new n(i,r)},transformPointSelf:function(t){var e=t.x,s=t.y;return t.x=this.m11*e+this.m12*s,t.y=this.m21*e+this.m22*s,t},clone:function(){return new r(this.m11,this.m12,this.m21,this.m22)}})}(e),function(t,e){var s=Math.sqrt,i=t.VecArray,n=t.Vector3=t.Class(Object,{__static__:{ZERO:function(){return new n([0,0,0])},dot:function(t,e){var s=t.xyz,i=e.xyz;return s[0]*i[0]+s[1]*i[1]+s[2]*i[2]},equals:function(t,e){var s=t.xyz,i=e.xyz;return s[0]==i[0]&&s[1]==i[1]&&s[2]==i[2]},cross:function(t,e){var s=t.xyz,i=e.xyz,r=s[0],h=s[1],o=s[2],u=i[0],a=i[1],c=i[2];return new n([h*c-o*a,o*u-r*c,r*a-h*u])},distance:function(t,e){var i=t.xyz,n=e.xyz,r=i[0]-n[0],h=i[1]-n[1],o=i[2]-n[2];return s(r*r+h*h+o*o)},sum:function(t,e){var s=t.xyz,i=e.xyz;return new n([s[0]+i[0],s[1]+i[1],s[2]+i[2]])}},constructor:function(t,s,n){t&&t.length?this.xyz=new i([t[0],t[1],t[2]]):(t=t===e?0:t,s=s===e?0:s,n=n===e?0:n,this.xyz=new i([t,s,n]))},xyz:null,dispose:function(){return this.xyz=null,this},getXYZ:function(){return new i(this.xyz)},getXYZRef:function(){return this.xyz},setXYZ:function(t){return this.xyz=new i(t),this},setXYZRef:function(t){return this.xyz=t,this},clone:function(){return new n(this.xyz)},equalsSelf:function(t){var e=this.xyz,s=t.xyz;return e[0]==s[0]&&e[1]==s[1]&&e[2]==s[2]},zeroSelf:function(){return this.xyz[0]=0,this.xyz[1]=0,this.xyz[2]=0,this},negate:function(){var t=this.xyz;return new n([-t[0],-t[1],-t[2]])},negateSelf:function(){var t=this.xyz;return t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],this},add:function(t){var e=this.xyz,s=t.xyz;return new n([e[0]+s[0],e[1]+s[1],e[2]+s[2]])},addSelf:function(t){var e=this.xyz,s=t.xyz;return e[0]+=s[0],e[1]+=s[1],e[2]+=s[2],this},subtract:function(t){var e=this.xyz,s=t.xyz;return new n([e[0]-s[0],e[1]-s[1],e[2]-s[2]])},subtractSelf:function(t){var e=this.xyz,s=t.xyz;return e[0]-=s[0],e[1]-=s[1],e[2]-=s[2],this},multiplyScalar:function(t){var e=this.xyz;return new n([e[0]*t,e[1]*t,e[2]*t])},multiplyScalarSelf:function(t){var e=this.xyz;return e[0]*=t,e[1]*=t,e[2]*=t,this},multiply:function(t){var e=this.xyz,s=t.xyz;return new n([e[0]*s[0],e[1]*s[1],e[2]*s[2]])},multiplySelf:function(t){var e=this.xyz,s=t.xyz;return e[0]*=s[0],e[1]*=s[1],e[2]*=s[2],this},divide:function(t){var e=1/t,s=this.xyz;return new n([s[0]*e,s[1]*e,s[2]*e])},divideSelf:function(t){var e=1/t,s=this.xyz;return s[0]*=e,s[1]*=e,s[2]*=e,this},normalize:function(){var t,e=this.xyz,i=e[0],r=e[1],h=e[2],o=i*i+r*r+h*h;return o>0&&(t=1/s(o),i*=t,r*=t,h*=t),new n([i,r,h])},normalizeSelf:function(){var t,e=this.xyz,i=e[0],n=e[1],r=e[2],h=i*i+n*n+r*r;return h>0&&(t=1/s(h),i*=t,n*=t,r*=t),e[0]=i,e[1]=n,e[2]=r,this},getMagnitude:function(){var t=this.xyz,e=t[0],i=t[1],n=t[2];return s(e*e+i*i+n*n)},setMagnitude:function(t){this.normalizeSelf();var e=this.xyz;return e[0]*=t,e[1]*=t,e[2]*=t,this},dotSelf:function(t){var e=this.xyz,s=t.xyz;return e[0]*s[0]+e[1]*s[1]+e[2]*s[2]},crossSelf:function(t){var e=this.xyz,s=t.xyz,i=e[0],n=e[1],r=e[2],h=s[0],o=s[1],u=s[2];return e[0]=n*u-r*o,e[1]=r*h-i*u,e[2]=i*o-n*h,this},distanceSelf:function(t){var e=this.xyz,i=t.xyz,n=e[0]-i[0],r=e[1]-i[1],h=e[2]-i[2];return s(n*n+r*r+h*h)},toString:function(){return"["+this.xyz[0]+" , "+this.xyz[1]+" , "+this.xyz[2]+"]"}})}(e),function(t,e){var s=Math.sin,i=Math.cos,n=t.Matrix4=t.Class(Object,{__static__:{multiplyVector:function(t,e){var s=e.xyz,i=s[0],n=s[1],r=s[2];return s[0]=i*t.n11+n*t.n12+r*t.n13+t.n14,s[1]=i*t.n21+n*t.n22+r*t.n23+t.n24,s[2]=i*t.n31+n*t.n32+r*t.n33+t.n34,e},calculateMultiply:function(t,e){var s=t.n11,i=e.n11,n=t.n21,r=e.n21,h=t.n31,o=e.n31,u=t.n12,a=e.n12,c=t.n22,l=e.n22,f=t.n32,d=e.n32,x=t.n13,m=e.n13,p=t.n23,y=e.n23,v=t.n33,g=e.n33,M=t.n14,w=e.n14,V=t.n24,z=e.n24,X=t.n34,A=e.n34;return t.n11=s*i+u*r+x*o,t.n12=s*a+u*l+x*d,t.n13=s*m+u*y+x*g,t.n14=s*w+u*z+x*A+M,t.n21=n*i+c*r+p*o,t.n22=n*a+c*l+p*d,t.n23=n*m+c*y+p*g,t.n24=n*w+c*z+p*A+V,t.n31=h*i+f*r+v*o,t.n32=h*a+f*l+v*d,t.n33=h*m+f*y+v*g,t.n34=h*w+f*z+v*A+X,t}},constructor:function(t,s,i,n,r,h,o,u,a,c,l,f,d,x,m,p){this.n11=t===e?1:t,this.n12=s===e?0:s,this.n13=i===e?0:i,this.n14=n===e?0:n,this.n21=r===e?0:r,this.n22=h===e?1:h,this.n23=o===e?0:o,this.n24=u===e?0:u,this.n31=a===e?0:a,this.n32=c===e?0:c,this.n33=l===e?1:l,this.n34=f===e?0:f,this.n41=d===e?0:d,this.n42=x===e?0:x,this.n43=m===e?0:m,this.n44=p===e?1:p},n11:1,n12:0,n13:0,n14:0,n21:0,n22:1,n23:0,n24:0,n31:0,n32:0,n33:1,n34:0,n41:0,n42:0,n43:0,n44:1,dispose:function(){return this.n11=null,this.n12=null,this.n13=null,this.n14=null,this.n21=null,this.n22=null,this.n23=null,this.n24=null,this.n31=null,this.n32=null,this.n33=null,this.n34=null,this.n41=null,this.n42=null,this.n43=null,this.n44=null,this},reset:function(){return this.n11=1,this.n12=0,this.n13=0,this.n14=0,this.n21=0,this.n22=1,this.n23=0,this.n24=0,this.n31=0,this.n32=0,this.n33=1,this.n34=0,this.n41=0,this.n42=0,this.n43=0,this.n44=1,this},translationMatrix:function(t,e,s){return this.n14=t,this.n24=e,this.n34=s,this},translationMatrixFromVector:function(t){var e=t.xyz;return this.n14=e[0],this.n24=e[1],this.n34=e[2],this},scaleMatrix:function(t,e,s){return this.n11=t,this.n22=e,this.n33=s,this},scaleMatrixFromVector:function(t){var e=t.xyz;return this.n11=e[0],this.n22=e[0],this.n33=e[0],this},rotationMatrix:function(t,e,n,r){var h=i(r),o=s(r),u=1-h,a=t*e*u,c=e*n*u,l=t*n*u,f=o*n,d=o*e,x=o*t;return this.n11=h+t*t*u,this.n12=-f+a,this.n13=d+l,this.n14=0,this.n21=f+a,this.n22=h+e*e*u,this.n23=-x+c,this.n24=0,this.n31=-d+l,this.n32=x+c,this.n33=h+n*n*u,this.n34=0,this},rotationMatrixFromVector:function(t,e){var n=t.xyz,r=n[0],h=n[1],o=n[2],u=i(e),a=s(e),c=1-u,l=r*h*c,f=h*o*c,d=r*o*c,x=a*o,m=a*h,p=a*r;return this.n11=u+r*r*c,this.n12=-x+l,this.n13=m+d,this.n14=0,this.n21=x+l,this.n22=u+h*h*c,this.n23=-p+f,this.n24=0,this.n31=-m+d,this.n32=p+f,this.n33=u+o*o*c,this.n34=0,this},multiply:function(t){return n.calculateMultiply(this,t),this},multiplyVector:function(t){var e=t.xyz,s=e[0],i=e[1],n=e[2];return e[0]=s*this.n11+i*this.n12+n*this.n13+this.n14,e[1]=s*this.n21+i*this.n22+n*this.n23+this.n24,e[2]=s*this.n31+i*this.n32+n*this.n33+this.n34,t}})}(e),function(t,e){var s=t.ModConstant,i=s.X,n=s.Y,r=s.Z,h=t.Vector3,o=t.VecArray;t.VertexProxy=t.Class(Object,{constructor:function(t){this.xyz=new o([0,0,0]),this.original=new o([0,0,0]),this.ratio=new o([0,0,0]),e!==t&&null!==t&&!1!==t&&this.setVertex(t)},vertex:null,xyz:null,original:null,ratio:null,dispose:function(){return this.vertex=null,this.xyz=null,this.original=null,this.ratio=null,this},setVertex:function(t){return this.vertex=t,this},getRatioVector:function(){return new h(this.ratio)},getRatio:function(t){switch(t){case i:return this.ratio[0];case n:return this.ratio[1];case r:return this.ratio[2]}return-1},getOriginalValue:function(t){switch(t){case i:return this.original[0];case n:return this.original[1];case r:return this.original[2]}return 0},setRatios:function(t,s,i){return t=t===e?0:t,s=s===e?0:s,i=i===e?0:i,this.ratio=new o([t,s,i]),this},setOriginalPosition:function(t,s,i){return t=t===e?0:t,s=s===e?0:s,i=i===e?0:i,this.original=new o([t,s,i]),this},getXYZ:function(){return new o(this.xyz)},getXYZRef:function(){return this.xyz},getX:function(){return this.xyz[0]},getY:function(){return this.xyz[1]},getZ:function(){return this.xyz[2]},setXYZ:function(t){return this.xyz=new o(t),this},setXYZRef:function(t){return this.xyz=t,this},setX:function(t){return this.xyz[0]=t,this},setY:function(t){return this.xyz[1]=t,this},setZ:function(t){return this.xyz[2]=t,this},getValue:function(t){switch(t){case i:return this.getX();case n:return this.getY();case r:return this.getZ()}return 0},setValue:function(t,e){switch(t){case i:this.setX(e);break;case n:this.setY(e);break;case r:this.setZ(e)}return this},reset:function(){return this.setXYZ(this.original),this},collapse:function(){return this.original=this.getXYZ(),this},getVector:function(){return new h(this.getXYZ())},setVector:function(t){this.setXYZ(t.xyz)}})}(e),function(t){t.FaceProxy=t.Class(Object,{constructor:function(){this.vertices=[]},vertices:null,dispose:function(){return this.vertices=null,this},addVertex:function(t){this.vertices.push(t)},getVertices:function(){return this.vertices}})}(e),function(t,e){var s=t.ModConstant,i=s.X,n=s.Y,r=s.Z,h=Math.min,o=Math.max;t.MeshProxy=t.Class(Object,{constructor:function(t){this.maxX=null,this.maxY=null,this.maxZ=null,this.minX=null,this.minY=null,this.minZ=null,this.maxAxis=null,this.midAxis=null,this.minAxis=null,this.width=null,this.height=null,this.depth=null,this.vertices=[],this.faces=[],this.mesh=null,e!==t&&this.setMesh(t)},maxX:null,maxY:null,maxZ:null,minX:null,minY:null,minZ:null,maxAxis:null,midAxis:null,minAxis:null,widht:null,height:null,depth:null,vertices:null,faces:null,mesh:null,dispose:function(){this.maxX=null,this.maxY=null,this.maxZ=null,this.minX=null,this.minY=null,this.minZ=null,this.maxAxis=null,this.midAxis=null,this.minAxis=null,this.widht=null,this.height=null,this.depth=null;var t,e;if(this.faces)for(e=this.faces.length,t=0;e>t;t++)this.faces[t].dispose();if(this.faces=null,this.vertices)for(e=this.vertices.length,t=0;e>t;t++)this.vertices[t].dispose();return this.vertices=null,this.mesh=null,this},setMesh:function(t){return this.mesh=t,this.vertices=[],this},getVertices:function(){return this.vertices},getFaces:function(){return this.faces},analyzeGeometry:function(){var t,e,s,u,a,c,l,f,d,x,m,p,y,v=this.vertices,g=v.length,M=g;for(g&&(t=v[0],e=t.getXYZ(),s=e[0],u=e[1],a=e[2],c=l=s,f=d=u,x=m=a);--M>=0;)t=v[M],e=t.getXYZ(),s=e[0],u=e[1],a=e[2],t.setOriginalPosition(s,u,a),c=h(c,s),f=h(f,u),x=h(x,a),l=o(l,s),d=o(d,u),m=o(m,a);p=l-c,y=d-f,depth=m-x,this.width=p,this.height=y,this.depth=depth,this.minX=c,this.maxX=l,this.minY=f,this.maxY=d,this.minZ=x,this.maxZ=m;var w=o(p,y,depth),V=h(p,y,depth);for(w==p&&V==y?(this.minAxis=n,this.midAxis=r,this.maxAxis=i):w==p&&V==depth?(this.minAxis=r,this.midAxis=n,this.maxAxis=i):w==y&&V==p?(this.minAxis=i,this.midAxis=r,this.maxAxis=n):w==y&&V==depth?(this.minAxis=r,this.midAxis=i,this.maxAxis=n):w==depth&&V==p?(this.minAxis=i,this.midAxis=n,this.maxAxis=r):w==depth&&V==y&&(this.minAxis=n,this.midAxis=i,this.maxAxis=r),M=g;--M>=0;)t=v[M],e=t.getXYZ(),t.setRatios((e[0]-c)/p,(e[1]-f)/y,(e[2]-x)/depth);return this},resetGeometry:function(){for(var t=this.vertices,e=t.length;--e>=0;)t[e].reset();return this.update(),this},collapseGeometry:function(){for(var t=this.vertices,e=t.length;--e>=0;)t[e].collapse();return this.update(),this.analyzeGeometry(),this},getMin:function(t){switch(t){case i:return this.minX;case n:return this.minY;case r:return this.minZ}return-1},getMax:function(t){switch(t){case i:return this.maxX;case n:return this.maxY;case r:return this.maxZ}return-1},getSize:function(t){switch(t){case i:return this.width;case n:return this.height;case r:return this.depth}return-1},update:function(){return this},postApply:function(){return this},updateMeshPosition:function(){return this}})}(e),function(t,e){var s=0,i=t.ModConstant.NONE;t.Modifier=t.Class(Object,{constructor:function(t){this.id=++s,this.name="Generic",this.mod=t||null,this.axes=i,this.constraint=i,this.enabled=!0},id:null,name:null,mod:null,axes:null,constraint:null,enabled:!0,dispose:function(){return this.mod=null,this.name=null,this.axes=null,this.constraint=null,this},enable:function(t){return e!==t?(this.enabled=!!t,this):this.enabled},constraintAxes:function(t){return this.axes=t||i,this},setConstraint:function(t){return this.constraint=t||i,this},setModifiable:function(t){return this.mod=t,this},getVertices:function(){return this.mod.getVertices()},apply:function(){return this},toString:function(){return"[Modifier "+this.name+"]"}})}(e),function(t){t.Library3d=t.Class(Object,{constructor:function(){this.id="",this.meshClass=null,this.vertexClass=null},id:"",meshClass:null,vertexClass:null})}(e),function(t){t.PluginFactory=t.StaticClass({getMeshProxy:function(t){var e=t.meshClass;return e?new e:null}})}(e),function(t){var e=t.PluginFactory.getMeshProxy,s=t.ModifierStack=t.Class(Object,{constructor:function(t,s){this.baseMesh=null,this.stack=[],this.lib3d=t,this.baseMesh=e(t),this.baseMesh.setMesh(s),this.baseMesh.analyzeGeometry()},lib3d:null,baseMesh:null,stack:null,dispose:function(t){if(this.lib3d=null,this.baseMesh.dispose(),this.baseMesh=null,t)for(;this.stack.length;)this.stack.pop().dispose();return this.stack=null,this},add:function(t){return t.setModifiable(this.baseMesh),this.stack.push(t),this},apply:function(){var t=this.stack,e=t.length,s=this.baseMesh,i=0;for(s.resetGeometry();e>i;)t[i].enabled&&t[i].apply(),i++;return s.update(),this},collapse:function(){return this.apply(),this.baseMesh.collapseGeometry(),this.stack.length=0,this},clear:function(){return this.stack.length=0,this},getMeshInfo:function(){return this.baseMesh}});s.prototype.addModifier=s.prototype.add}(e),function(t){function e(t,e,s){this.x=t,this.y=e,this.z=s}function s(t){return t*t*t*(t*(6*t-15)+10)}function i(t,e,s){return(1-s)*t+s*e}var n=t.noise={};e.prototype.dot2=function(t,e){return this.x*t+this.y*e},e.prototype.dot3=function(t,e,s){return this.x*t+this.y*e+this.z*s};var r=[new e(1,1,0),new e(-1,1,0),new e(1,-1,0),new e(-1,-1,0),new e(1,0,1),new e(-1,0,1),new e(1,0,-1),new e(-1,0,-1),new e(0,1,1),new e(0,-1,1),new e(0,1,-1),new e(0,-1,-1)],h=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],o=new Array(512),u=new Array(512);n.seed=function(t){t>0&&1>t&&(t*=65536),t=Math.floor(t),256>t&&(t|=t<<8);for(var e=0;256>e;e++){var s;s=1&e?h[e]^255&t:h[e]^255&t>>8,o[e]=o[e+256]=s,u[e]=u[e+256]=r[s%12]}},n.seed(0);var a=.5*(Math.sqrt(3)-1),c=(3-Math.sqrt(3))/6,l=1/3,f=1/6;n.simplex2=function(t,e){var s,i,n,r,h,l=(t+e)*a,f=Math.floor(t+l),d=Math.floor(e+l),x=(f+d)*c,m=t-f+x,p=e-d+x;m>p?(r=1,h=0):(r=0,h=1);var y=m-r+c,v=p-h+c,g=m-1+2*c,M=p-1+2*c;f&=255,d&=255;var w=u[f+o[d]],V=u[f+r+o[d+h]],z=u[f+1+o[d+1]],X=.5-m*m-p*p;0>X?s=0:(X*=X,s=X*X*w.dot2(m,p));var A=.5-y*y-v*v;0>A?i=0:(A*=A,i=A*A*V.dot2(y,v));var P=.5-g*g-M*M;return 0>P?n=0:(P*=P,n=P*P*z.dot2(g,M)),70*(s+i+n)},n.simplex3=function(t,e,s){var i,n,r,h,a,c,d,x,m,p,y=(t+e+s)*l,v=Math.floor(t+y),g=Math.floor(e+y),M=Math.floor(s+y),w=(v+g+M)*f,V=t-v+w,z=e-g+w,X=s-M+w;V>=z?z>=X?(a=1,c=0,d=0,x=1,m=1,p=0):V>=X?(a=1,c=0,d=0,x=1,m=0,p=1):(a=0,c=0,d=1,x=1,m=0,p=1):X>z?(a=0,c=0,d=1,x=0,m=1,p=1):X>V?(a=0,c=1,d=0,x=0,m=1,p=1):(a=0,c=1,d=0,x=1,m=1,p=0);var A=V-a+f,P=z-c+f,Y=X-d+f,Z=V-x+2*f,C=z-m+2*f,b=X-p+2*f,I=V-1+3*f,O=z-1+3*f,R=X-1+3*f;v&=255,g&=255,M&=255;var S=u[v+o[g+o[M]]],T=u[v+a+o[g+c+o[M+d]]],E=u[v+x+o[g+m+o[M+p]]],N=u[v+1+o[g+1+o[M+1]]],$=.5-V*V-z*z-X*X;0>$?i=0:($*=$,i=$*$*S.dot3(V,z,X));var k=.5-A*A-P*P-Y*Y;0>k?n=0:(k*=k,n=k*k*T.dot3(A,P,Y));var _=.5-Z*Z-C*C-b*b;0>_?r=0:(_*=_,r=_*_*E.dot3(Z,C,b));var F=.5-I*I-O*O-R*R;return 0>F?h=0:(F*=F,h=F*F*N.dot3(I,O,R)),32*(i+n+r+h)},n.perlin2=function(t,e){var n=Math.floor(t),r=Math.floor(e);t-=n,e-=r,n=255&n,r=255&r;var h=u[n+o[r]].dot2(t,e),a=u[n+o[r+1]].dot2(t,e-1),c=u[n+1+o[r]].dot2(t-1,e),l=u[n+1+o[r+1]].dot2(t-1,e-1),f=s(t);return i(i(h,c,f),i(a,l,f),s(e))},n.perlin3=function(t,e,n){var r=Math.floor(t),h=Math.floor(e),a=Math.floor(n);t-=r,e-=h,n-=a,r=255&r,h=255&h,a=255&a;var c=u[r+o[h+o[a]]].dot3(t,e,n),l=u[r+o[h+o[a+1]]].dot3(t,e,n-1),f=u[r+o[h+1+o[a]]].dot3(t,e-1,n),d=u[r+o[h+1+o[a+1]]].dot3(t,e-1,n-1),x=u[r+1+o[h+o[a]]].dot3(t-1,e,n),m=u[r+1+o[h+o[a+1]]].dot3(t-1,e,n-1),p=u[r+1+o[h+1+o[a]]].dot3(t-1,e-1,n),y=u[r+1+o[h+1+o[a+1]]].dot3(t-1,e-1,n-1),v=s(t),g=s(e),M=s(n);return i(i(i(c,x,v),i(l,m,v),M),i(i(f,p,v),i(d,y,v),M),g)}}(this),function(t){var e=t.Vector3;t.Pivot=t.Class(t.Modifier,{constructor:function(t,s,i){this.$super("constructor"),this.name="Pivot",this.pivot=new e([t,s,i])},pivot:null,dispose:function(){return this.pivot.dispose(),this.pivot=null,this.$super("dispose"),this},setMeshCenter:function(){var t=this.mod;return this.pivot=new e(-(t.minX+.5*t.width),-(t.minY+.5*t.height),-(t.minZ+.5*t.depth)),this},apply:function(){for(var t,e=this.mod.vertices,s=e.length,i=this.pivot;--s>=0;)t=e[s],t.setVector(t.getVector().addSelf(i));return this.mod.updateMeshPosition(i.negate()),this}})}(e),function(t,e){var s=t.ModConstant.NONE,i=t.ModConstant.LEFT,n=t.ModConstant.RIGHT,r=t.Matrix,h=Math.atan,o=(Math.atan2,Math.sin),u=Math.cos,a=t.Constants.PI,c=t.Constants.halfPI,l=t.Constants.doublePI,f=t.Point;t.Bend=t.Class(t.Modifier,{constructor:function(t,i,n){this.$super("constructor"),this.name="Bend",this.constraint=s,this.max=0,this.min=0,this.mid=0,this.width=0,this.height=0,this.origin=0,this.m1=null,this.m2=null,this.diagAngle=0,this.switchAxes=!1,this.force=t!==e?t:0,this.offset=i!==e?i:0,n!==e?this.setAngle(n):this.setAngle(0)},force:0,offset:0,angle:0,diagAngle:0,max:0,min:0,mid:0,width:0,height:0,origin:0,m1:null,m2:null,switchAxes:!1,dispose:function(){return this.force=null,this.offset=null,this.angle=null,this.diagAngle=null,this.max=null,this.min=null,this.mid=null,this.width=null,this.height=null,this.origin=null,this.m1&&this.m1.dispose(),this.m2&&this.m2.dispose(),this.m1=null,this.m2=null,this.switchAxes=null,this.$super("dispose"),this},setAngle:function(t){return this.angle=t,this.m1=(new r).rotate(t),this.m2=(new r).rotate(-t),this},setModifiable:function(t){return this.$super("setModifiable",t),this.max=this.switchAxes?this.mod.midAxis:this.mod.maxAxis,this.min=this.mod.minAxis,this.mid=this.switchAxes?this.mod.maxAxis:this.mod.midAxis,this.width=this.mod.getSize(this.max),this.height=this.mod.getSize(this.mid),this.origin=this.mod.getMin(this.max),this.diagAngle=h(this.width/this.height),this},apply:function(){if(!this.force)return this;for(var t,e,s,r,h,d,x,m,p,y,v=this.mod.vertices,g=v.length,M=this.constraint,w=this.width,V=this.offset,z=this.origin,X=this.force,A=this.max,P=this.min,Y=this.mid,Z=this.m1,C=this.m2,b=z+w*V,I=w/a/X,O=l*(w/(I*l)),R=1/w;--g>=0;)t=v[g],e=t.getValue(A),s=t.getValue(Y),r=t.getValue(P),h=Z.transformPointSelf(new f(e,s)),e=h.x,s=h.y,d=(e-z)*R,i===M&&V>=d||n===M&&d>=V||(x=c-O*V+O*d,m=o(x)*(I+r),p=u(x)*(I+r),r=m-I,e=b-p),y=C.transformPointSelf(new f(e,s)),e=y.x,s=y.y,t.setValue(A,e),t.setValue(Y,s),t.setValue(P,r);return this}})}(e),function(t){var e=t.Vector3,s=Math.max,i=Math.exp;t.Bloat=t.Class(t.Modifier,{constructor:function(){this.$super("constructor"),this.name="Bloat",this.radius=0,this.a=.01,this.center=e.ZERO()},center:null,radius:0,a:.01,dispose:function(){return this.center.dispose(),this.center=null,this.radius=null,this.a=null,this.$super("dispose"),this},setRadius:function(t){return this.radius=s(0,t),this},setA:function(t){return this.a=s(0,t),this},apply:function(){for(var t,e,s,n=this.mod.vertices,r=n.length,h=this.center,o=this.radius,u=this.a;--r>=0;)t=n[r],s=t.getVector().subtractSelf(h),e=s.getMagnitude(),s.setMagnitude(e+o*i(-e*u)),t.setVector(s.addSelf(h));return this}})}(e),function(t,e){var s=t.Vector3,i=t.Matrix4;t.Twist=t.Class(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Twist",this.vector=new s([0,1,0]).normalizeSelf(),this.angle=t!==e?t:0,this.center=s.ZERO(),this.mat1=new i,this.mat2=new i},vector:null,angle:0,center:null,mat1:null,mat2:null,dispose:function(){return this.vector.dispose(),this.vector=null,this.angle=null,this.center.dispose(),this.center=null,this.mat1.dispose(),this.mat2.dispose(),this.mat1=null,this.mat2=null,this.$super("dispose"),this},apply:function(){for(var t,e,i,n=this.mod,r=n.vertices,h=r.length,o=this.vector,u=this.angle,a=this.center,c=new s([.5*n.maxX,.5*n.maxY,.5*n.maxZ]),l=1/c.getMagnitude(),f=l*u,d=-s.dot(o,a);--h>=0;)t=r[h],i=t.getVector(),e=s.dot(i,o)+d,t.setVector(this.twistPoint(i,o,e*f));return this},twistPoint:function(t,e,i){var n=this.mat1.reset().translationMatrixFromVector(t),r=this.mat2.reset().rotationMatrixFromVector(e,i);return r.multiply(n),new s([r.n14,r.n24,r.n34])}})}(e),function(t,e){var s=Math.abs,i=Math.pow,n=(t.XMath.sign,t.ModConstant),r=n.NONE,h=n.LEFT,o=n.RIGHT,u=n.X,a=n.Y,c=n.Z;t.Skew=t.Class(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Skew",this.force=t!==e?t:0,this.offset=.5,this.constraint=r,this.power=1,this.falloff=1,this.inverseFalloff=!1,this.oneSide=!1,this.swapAxes=!1,this.skewAxis=0},force:0,skewAxis:0,offset:.5,power:1,falloff:1,inverseFalloff:!1,oneSide:!1,swapAxes:!1,dispose:function(){return this.force=null,this.skewAxis=null,this.offset=null,this.power=null,this.falloff=null,this.inverseFalloff=null,this.oneSide=null,this.swapAxes=null,this.$super("dispose"),this},setModifiable:function(t){return this.$super("setModifiable",t),this.skewAxis=this.skewAxis||this.mod.maxAxis,this},apply:function(){for(var t,e,n,r,u,a,c,l,f=this.mod.vertices,d=f.length,x=this.constraint,m=this.skewAxis,p=this.offset,y=this.oneSide,v=this.inverseFalloff,g=this.falloff,M=1-g,w=this.power,V=this.force,z=this.getDisplaceAxis();--d>=0;)t=f[d],c=t.getRatio(m),h===x&&p>=c||o===x&&c>p||(e=c-p,y&&(e=s(e)),n=t.getRatio(z),v&&(n=1-n),r=g+n*M,l=0>e?-1:1,u=i(s(e),w)*l,a=t.getValue(z)+V*u*r,t.setValue(z,a));return this},getDisplaceAxis:function(){var t=this.skewAxis,e=this.swapAxes;switch(t){case u:return e?c:a;case a:return e?c:u;case c:return e?a:u}}})}(e),function(t,e){var s=t.Vector3,i=t.Matrix4,n=Math.pow;t.Taper=t.Class(t.Modifier,{constructor:function(t,i){this.$super("constructor"),this.name="Taper",this.vector=new s([1,0,1]),this.vector2=new s([0,1,0]),this.force=t!==e?t:0,this.power=i!==e?i:1},force:0,power:1,vector:null,vector2:null,dispose:function(){return this.vector.dispose(),this.vector2.dispose(),this.vector=null,this.vector2=null,this.force=null,this.power=null,this.$super("dispose"),this},apply:function(){var t,e,s,r,h,o,u=this.mod.vertices,a=u.length,c=this.vector,l=this.vector2,f=this.force,d=this.power;for(r=new i;--a>=0;)t=u[a],e=t.getRatioVector().multiply(l),s=1!==d?f*n(e.getMagnitude(),d):f*e.getMagnitude(),o=c.xyz,r.reset().scaleMatrix(1+s*o[0],1+s*o[1],1+s*o[2]),h=t.getVector(),t.setVector(r.multiplyVector(h));return this}})}(e),function(t){var e=t.Constants.invPI,s=t.Constants.doublePI,i=t.Vector3,n=t.Matrix4;t.Wheel=t.Class(t.Modifier,{constructor:function(){this.$super("constructor"),this.name="Wheel",this.speed=0,this.turn=0,this.roll=0,this.radius=0,this.steerVector=new i([0,1,0]),this.rollVector=new i([0,0,1])},speed:0,turn:0,roll:0,radius:0,steerVector:null,rollVector:null,dispose:function(){return this.speed=null,this.turn=null,this.roll=null,this.radius=null,this.steerVector.dispose(),this.rollVector.dispose(),this.steerVector=null,this.rollVector=null,this.$super("dispose"),this},setModifiable:function(t){return this.$super("setModifiable",t),this.radius=.5*this.mod.width,this},apply:function(){var t,e,s=this.mod.vertices,i=s.length,r=this.steerVector,h=this.turn,o=this.rollVector,u=this.roll,a=null,c=null,l=null;for(this.roll+=this.speed,h?(c=(new n).rotationMatrixFromVector(r,h),l=c.multiplyVector(o.clone()),a=(new n).rotationMatrixFromVector(l,u)):a=(new n).rotationMatrixFrom(o,u);--i>=0;)t=s[i],e=t.getVector(),c&&c.multiplyVector(e),t.setVector(a.multiplyVector(e));return this},getStep:function(){return this.radius*this.speed*e},getPerimeter:function(){return this.radius*s}})}(e),function(t,e){var s=t.Vector3,i=t.Range,n=t.Matrix4;t.Break=t.Class(t.Modifier,{constructor:function(t,n){this.$super("constructor"),this.name="Break",this.bv=new s([0,1,0]),this.range=new i(0,1),this.offset=t!==e?t:0,this.angle=n!==e?n:0},bv:null,range:null,offset:0,angle:0,dispose:function(){return this.bv.dispose(),this.bv=null,this.range.dispose(),this.range=null,this.offset=null,this.angle=null,this.$super("dispose"),this},apply:function(){var t,e,i,r,h,o=this.mod,u=o.vertices,a=u.length,c=this.offset,l=this.range,f=this.angle,d=this.bv,x=d.xyz;for(t=new s([0,0,-(o.minZ+o.depth*c)]),e=t.negate(),h=(new n).rotationMatrix(x[0],x[1],x[2],f);--a>=0;)i=u[a],r=i.getVector().addSelf(t),r.xyz[2]>=0&&l.isIn(i.ratio[1])&&h.multiplyVector(r),i.setVector(r.addSelf(e));return this}})}(e),function(t,e){var s=t.ModConstant.NONE,i=t.ModConstant.X,n=t.ModConstant.Y,r=t.ModConstant.Z,h=(t.VecArray,Math.random);t.Noise=t.Class(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Noise",this.axes=s,this.start=0,this.end=0,this.force=t!==e?t:0},force:0,start:0,end:1,dispose:function(){return this.force=null,this.start=null,this.end=null,this.$super("dispose"),this},setFalloff:function(t,s){return this.start=t!==e?t:0,this.end=s!==e?s:1,this},apply:function(){var t,e,s,o,u,a=this.mod,c=this.axes,l=this.start,f=this.end,d=a.vertices,x=d.length,m=this.force,p=.5*m,y=a.maxAxis;if(!c||!m)return this;for(;--x>=0;)t=d[x],e=h()*m-p,s=t.getRatio(y),f>l?l>s?s=0:s>f&&(s=1):l>f?(s=1-s,s>l?s=0:f>s&&(s=1)):s=1,o=e*s,u=t.getXYZ(),t.setXYZ([u[0]+(c&i?0:o),u[1]+(c&n?0:o),u[2]+(c&r?0:o)]);return this}})}(e),function(t){var e=t.ModConstant,s=(e.NONE,e.X),i=e.Y,n=e.Z;t.DisplaceMap=t.Class(t.Modifier,{constructor:function(t,e,r,h){this.$super("constructor"),this.name="DisplaceMap",arguments.length>=3?(this.setBitmap(t,e,r),this.force=h||1):this.force=t||1,this.offset=127,this.axes=s|i|n},width:null,height:null,bitmapData:null,force:1,offset:127,dispose:function(){return this.bitmapData=null,this.width=null,this.height=null,this.force=null,this.offset=null,this.$super("dispose"),this},setBitmap:function(t,e,s){return this.bitmapData=t||null,this.width=e||0,this.height=s||0,this},apply:function(){var t,e,r,h,o,u=this.mod.vertices,a=u.length,c=this.axes,l=this.width,f=this.height,d=this.bitmapData,x=this.force,m=this.offset;if(!c||!d)return this;for(;--a>=0;)t=u[a],o=t.getXYZ(),r=~~((l-1)*t.ratio[0]),h=~~((f-1)*t.ratio[2]),e=h*l+r<<2,c&s&&(o[0]+=((255&d[e]>>16)-m)*x),c&i&&(o[1]+=((255&d[e+1]>>8)-m)*x),c&n&&(o[2]+=((255&d[e+2])-m)*x),t.setXYZ(o);return this}})}(e),function(t,e){var s=(t.Vector3,Math.round),i=t.VecArray,n=t.ModConstant,r=(n.NONE,n.X),h=n.Y,o=n.Z,u=t.PerlinNoise=t.Class(Object,{constructor:function(t,i){this.width=e!==t?s(t):10,this.height=e!==i?s(i):10},width:10,height:10,data:null,dispose:function(){return this.data=null,this.width=this.height=null,this},uvIndex:function(t,e){var s=this.width,i=this.height,n=~~((s-1)*t),r=~~((i-1)*e);return n+r*s},generate:function(){var t,e,s,n=this.width,r=this.height,h=n*r,o=new i(h);for(t=0,e=0,s=0;h>s;s++,t++)t>=n&&(t=0,e++),o[s]=noise.simplex2(t/n,e/r);return this.data=o,this},move:function(t,e){var s,n,r,h,o,u,a=this.width,c=this.height,l=a*c,f=this.data,d=new i(l);for(0>t&&(t+=a),0>e&&(e+=c),t=~~t,e=~~e,s=0,n=0,o=0;l>o;o++,s++)s>=a&&(s=0,n++),r=(s+t)%a,h=(n+e)%c,u=r+h*a,d[o]=f[u];return this.data=d,this}});t.Perlin=t.Class(t.Modifier,{constructor:function(t,s,i){this.$super("constructor"),this.name="Perlin",this.source=e===s?new u(25,25).generate():s,this.force=t||1,this.autoRun=e!==i?!!i:!0,this.axes=r|h|o},speedX:1,speedY:1,source:null,force:1,offset:0,autoRun:!0,dispose:function(){return this.source=null,this.speedX=null,this.speedY=null,this.force=null,this.offset=null,this.autoRun=null,this.$super("dispose"),this
},setSpeed:function(t,e){return this.speedX=t,this.speedY=e,this},apply:function(){var t,e,s,i=this.mod.vertices,n=i.length,u=this.axes,a=this.force,c=this.offset,l=this.source;if(!u||!l)return this;for(this.autoRun&&l.move(this.speedX,this.speedY),t=l.data;--n>=0;)e=i[n],xyz=e.getXYZ(),s=l.uvIndex(e.ratio[0],e.ratio[2]),u&r&&(xyz[0]+=(t[s]-c)*a),u&h&&(xyz[1]+=(t[s]-c)*a),u&o&&(xyz[2]+=(t[s]-c)*a),e.setXYZ(xyz);return this}})}(e),function(t){var e=t.ModConstant,s=e.X,i=e.Y,n=e.Z,r=t.Vector3,h=t.VecArray,o=t.VertexThree=t.Class(t.VertexProxy,{constructor:function(t,e){this.mesh=t,this.$super("constructor",e)},mesh:null,dispose:function(){return this.mesh=null,this.$super("dispose"),this},setVertex:function(t){return this.vertex=t,this.original=new h([t.x,t.y,t.z]),this.xyz=new h(this.original),this},getXYZ:function(){var t=this.vertex;return new h([t.x,t.y,t.z])},getX:function(){return this.vertex.x},getY:function(){return this.vertex.y},getZ:function(){return this.vertex.z},setXYZ:function(t){var e=this.vertex;return this.mesh.geometry,e.x=t[0],e.y=t[1],e.z=t[2],this},setX:function(t){var e=this.vertex;return e.x=t,this},setY:function(t){var e=this.vertex;return e.y=t,this},setZ:function(t){var e=this.vertex;return e.z=t,this},reset:function(){var t=this.vertex,e=(this.mesh.geometry,this.original);return t.x=e[0],t.y=e[1],t.z=e[2],this},collapse:function(){var t=this.vertex;return this.original=new h([t.x,t.y,t.z]),this},getValue:function(t){var e=this.vertex;switch(t){case s:return e.x;case i:return e.y;case n:return e.z}return 0},setValue:function(t,e){var r=this.vertex,h=!1;switch(t){case s:r.x=e,h=!0;break;case i:r.y=e,h=!0;break;case n:r.z=e,h=!0}return this},setVector:function(t){var e=this.vertex,s=t.xyz;return this.mesh.geometry,e.x=s[0],e.y=s[1],e.z=s[2],this},getVector:function(){var t=this.vertex;return new r([t.x,t.y,t.z])}});o.prototype.getXYZRef=o.prototype.getXYZ,o.prototype.setXYZRef=o.prototype.setXYZ}(e),function(t){var e=t.VertexThree;t.FaceProxy,t.MeshThree=t.Class(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var s,i=0,t=this.mesh,n=this.vertices,r=t.geometry.vertices,h=r.length,o=t.geometry.faces;for(o.length,i=0;h>i;)s=new e(t,r[i]),n.push(s),i++;return this.faces=null,this},update:function(){var t=this.mesh.geometry;return t.verticesNeedUpdate=!0,t.normalsNeedUpdate=!0,t.buffersNeedUpdate=!0,t.dynamic=!0,this},updateMeshPosition:function(t){var e=this.mesh.position,s=t.xyz;return e.x+=s[0],e.y+=s[1],e.z+=s[2],this}})}(e),function(t){var e=t.Class(t.Library3d,{constructor:function(){this.id="Three.js",this.meshClass=t.MeshThree,this.vertexClass=t.VertexThree}});t.LibraryThree=new e}(e),function(t){var e=t.ModConstant,s=e.X,i=e.Y,n=e.Z,r=t.Vector3,h=t.VecArray,o=t.VertexJ3D=t.Class(t.VertexProxy,{constructor:function(t,e){this.geometry=t,this.VERTEX_POSITION=J3D.Mesh.VERTEX_POSITION,this.$super("constructor",e)},geometry:null,VERTEX_POSITION:null,dispose:function(){return this.VERTEX_POSITION=null,this.geometry=null,this.$super("dispose"),this},setVertex:function(t){var e=this.geometry,s=e.arraysByName[this.VERTEX_POSITION],i=s.data;return this.vertex=t,this.original=new h([i[t],i[t+1],i[t+2]]),this.xyz=new h(this.original),this},getXYZ:function(){var t=this.vertex,e=this.geometry,s=e.arraysByName[this.VERTEX_POSITION],i=s.data;return new h([i[t],i[t+1],i[t+2]])},getX:function(){var t=this.vertex,e=this.geometry,s=e.arraysByName[this.VERTEX_POSITION],i=s.data;return i[t]},getY:function(){var t=this.vertex,e=this.geometry,s=e.arraysByName[this.VERTEX_POSITION],i=s.data;return i[t+1]},getZ:function(){var t=this.vertex,e=this.geometry,s=e.arraysByName[this.VERTEX_POSITION],i=s.data;return i[t+2]},setXYZ:function(t){var e=this.vertex,s=this.geometry,i=s.arraysByName[this.VERTEX_POSITION],n=i.data;return n[e]=t[0],n[e+1]=t[1],n[e+2]=t[2],this},setX:function(t){var e=this.vertex,s=this.geometry,i=s.arraysByName[this.VERTEX_POSITION],n=i.data;return n[e]=t,this},setY:function(t){var e=this.vertex,s=this.geometry,i=s.arraysByName[this.VERTEX_POSITION],n=i.data;return n[e+1]=t,this},setZ:function(t){var e=this.vertex,s=this.geometry,i=s.arraysByName[this.VERTEX_POSITION],n=i.data;return n[e+2]=t,this},reset:function(){var t=this.vertex,e=this.geometry,s=e.arraysByName[this.VERTEX_POSITION],i=s.data,n=this.original;return i[t]=n[0],i[t+1]=n[1],i[t+2]=n[2],this},collapse:function(){var t=this.vertex,e=this.geometry,s=e.arraysByName[this.VERTEX_POSITION],i=s.data;return this.original=new h([i[t],i[t+1],i[t+2]]),this},getValue:function(t){var e=this.vertex,r=this.geometry,h=r.arraysByName[this.VERTEX_POSITION],o=h.data;switch(t){case s:return o[e];case i:return o[e+1];case n:return o[e+2]}return 0},setValue:function(t,e){var r=this.vertex,h=this.geometry,o=h.arraysByName[this.VERTEX_POSITION],u=o.data,a=!1;switch(t){case s:u[r]=e,a=!0;break;case i:u[r+1]=e,a=!0;break;case n:u[r+2]=e,a=!0}return this},setVector:function(t){var e=this.vertex,s=this.geometry,i=s.arraysByName[this.VERTEX_POSITION],n=i.data,r=t.xyz;return n[e]=r[0],n[e+1]=r[1],n[e+2]=r[2],this},getVector:function(){var t=this.vertex,e=this.geometry,s=e.arraysByName[this.VERTEX_POSITION],i=s.data;return new r([i[t],i[t+1],i[t+2]])}});o.prototype.getXYZRef=o.prototype.getXYZ,o.prototype.setXYZRef=o.prototype.setXYZ}(e),function(t){var e=t.VertexJ3D;t.FaceProxy,t.VecArray,t.MeshJ3D=t.Class(t.MeshProxy,{constructor:function(t){this.VERTEX_POSITION=J3D.Mesh.VERTEX_POSITION,this.$super("constructor",t)},VERTEX_POSITION:null,dispose:function(){return this.VERTEX_POSITION=null,this.$super("dispose"),this},setMesh:function(t){this.$super("setMesh",t);var s,i=0,n=t.geometry,r=n.arraysByName[this.VERTEX_POSITION],h=r.data,o=h.length,u=r.itemSize,a=this.vertices;for(i=0;o>i;)s=new e(n,i),a.push(s),i+=u;return this.faces=null,this},update:function(){var t=this.mesh.geometry,e=t.arraysByName[this.VERTEX_POSITION],s=e.data;return t.replaceArray(e,s),this},updateMeshPosition:function(t){var e=this.mesh.position,s=t.xyz;return e.x+=s[0],e.y+=s[1],e.z+=s[2],this}})}(e),function(t){var e=t.Class(t.Library3d,{constructor:function(){this.id="J3D",this.meshClass=t.MeshJ3D,this.vertexClass=t.VertexJ3D}});t.LibraryJ3D=new e}(e),function(t){var e=t.ModConstant,s=e.X,i=e.Y,n=e.Z,r=t.Vector3,h=t.VecArray,o=t.VertexCopperlicht=t.Class(t.VertexProxy,{constructor:function(t,e,s){this.node=t,this.buffer=e,this.$super("constructor",s)},node:null,buffer:null,dispose:function(){return this.node=null,this.buffer=null,this.$super("dispose"),this},setVertex:function(t){var e=t.Pos;return this.vertex=t,this.original=new h([e.X,e.Y,e.Z]),this.xyz=new h(this.original),this},getXYZ:function(){var t=this.vertex.Pos;return new h([t.X,t.Y,t.Z])},getX:function(){return this.vertex.Pos.X},getY:function(){return this.vertex.Pos.Y},getZ:function(){return this.vertex.Pos.Z},setXYZ:function(t){var e=this.vertex.Pos;return e.X=t[0],e.Y=t[1],e.Z=t[2],this},setX:function(t){var e=this.vertex.Pos;return e.X=t,this},setY:function(t){var e=this.vertex.Pos;return e.Y=t,this},setZ:function(t){var e=this.vertex.Pos;return e.Z=t,this},reset:function(){var t=this.vertex.Pos,e=this.original;return t.X=e[0],t.Y=e[1],t.Z=e[2],this},collapse:function(){var t=this.vertex.Pos;return this.original=new h([t.X,t.Y,t.Z]),this},getValue:function(t){var e=this.vertex.Pos;switch(t){case s:return e.X;case i:return e.Y;case n:return e.Z}return 0},setValue:function(t,e){var r=this.vertex.Pos,h=!1;switch(t){case s:r.X=e,h=!0;break;case i:r.Y=e,h=!0;break;case n:r.Z=e,h=!0}return this},setVector:function(t){var e=this.vertex.Pos,s=t.xyz;return e.X=s[0],e.Y=s[1],e.Z=s[2],this},getVector:function(){var t=this.vertex.Pos;return new r([t.X,t.Y,t.Z])}});o.prototype.getXYZRef=o.prototype.getXYZ,o.prototype.setXYZRef=o.prototype.setXYZ}(e),function(t){var e=t.VertexCopperlicht;t.FaceProxy,t.MeshCopperlicht=t.Class(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var s,i,n,r,h,o=this.mesh.getMesh().GetMeshBuffers(),u=this.vertices,a=[];for(i=0,n=o.length;n>i;i++)for(a=o[i].Vertices,s=0,r=a.length;r>s;s++)h=new e(this.mesh,o[i],a[s]),u.push(h);return this.faces=null,this},update:function(){for(var t=this.mesh.getMesh().GetMeshBuffers(),e=t.length,s=0;e>s;)t[s].update(!0),s++;return this},updateMeshPosition:function(t){var e=this.mesh.Pos,s=t.xyz;return e.X+=s[0],e.Y+=s[1],e.Z+=s[2],this}})}(e),function(t){var e=t.Class(t.Library3d,{constructor:function(){this.id="Copperlicht",this.meshClass=t.MeshCopperlicht,this.vertexClass=t.VertexCopperlicht}});t.LibraryCopperlicht=new e}(e),function(t){var e=t.ModConstant,s=e.X,i=e.Y,n=e.Z,r=t.Vector3,h=t.VecArray,o=t.VertexCubicVR=t.Class(t.VertexProxy,{constructor:function(t,e){this.sceneObject=t,this.$super("constructor",e)},sceneObject:null,dispose:function(){return this.sceneObject=null,this.$super("dispose"),this},setVertex:function(t){return this.vertex=t,this.original=new h(t),this.xyz=new h(t),this},getXYZ:function(){return new h(this.vertex)},getX:function(){return this.vertex[0]},getY:function(){return this.vertex[1]},getZ:function(){return this.vertex[2]},setXYZ:function(t){var e=this.vertex;return e[0]=t[0],e[1]=t[1],e[2]=t[2],this},setX:function(t){var e=this.vertex;return e[0]=t,this},setY:function(t){var e=this.vertex;return e[1]=t,this},setZ:function(t){var e=this.vertex;return e[2]=t,this},reset:function(){var t=this.vertex,e=this.original;return t[0]=e[0],t[1]=e[1],t[2]=e[2],this},collapse:function(){return this.original=new h(this.vertex),this},getValue:function(t){var e=this.vertex;switch(t){case s:return e[0];case i:return e[1];case n:return e[2]}return 0},setValue:function(t,e){var r=this.vertex,h=!1;switch(t){case s:r[0]=e,h=!0;break;case i:r[1]=e,h=!0;break;case n:r[2]=e,h=!0}return this},setVector:function(t){var e=this.vertex,s=t.xyz;return e[0]=s[0],e[1]=s[1],e[2]=s[2],this},getVector:function(){return new r(this.vertex)}});o.prototype.getXYZRef=o.prototype.getXYZ,o.prototype.setXYZRef=o.prototype.setXYZ}(e),function(t){var e=t.VertexCubicVR;t.FaceProxy,t.MeshCubicVR=t.Class(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var s,i=0,n=t.obj.points,r=n.length,h=t.obj.faces,o=(h.length,this.vertices);for(i=0;r>i;)s=new e(t,n[i]),o.push(s),i++;return this.faces=null,this},update:function(){return this.mesh.dirty=!0,this},updateMeshPosition:function(t){var e=this.mesh.position,s=t.xyz;return e[0]+=s[0],e[1]+=s[1],e[2]+=s[2],this}})}(e),function(t){var e=t.Class(t.Library3d,{constructor:function(){this.id="CubicVR.js",this.meshClass=t.MeshCubicVR,this.vertexClass=t.VertexCubicVR}});t.LibraryCubicVR=new e}(e),function(t){var e=t.ModConstant,s=e.X,i=e.Y,n=e.Z,r=t.Vector3,h=t.VecArray,o=t.VertexPre3D=t.Class(t.VertexProxy,{constructor:function(t){this.$super("constructor",t)},setVertex:function(t){return this.vertex=t,this.original=new h([t.x,t.y,t.z]),this.xyz=new h(this.original),this},getXYZ:function(){var t=this.vertex;return new h([t.x,t.y,t.z])},getX:function(){return this.vertex.x},getY:function(){return this.vertex.y},getZ:function(){return this.vertex.z},setXYZ:function(t){var e=this.vertex;return e.x=t[0],e.y=t[1],e.z=t[2],this},setX:function(t){return this.vertex.x=t,this},setY:function(t){return this.vertex.y=t,this},setZ:function(t){return this.vertex.z=t,this},getValue:function(t){var e=this.vertex;switch(t){case s:return e.x;case i:return e.y;case n:return e.z}return 0},setValue:function(t,e){var r=this.vertex;switch(t){case s:r.x=e;break;case i:r.y=e;break;case n:r.z=e}return this},setVector:function(t){var e=this.vertex,s=t.xyz;return e.x=s[0],e.y=s[1],e.z=s[2],this},getVector:function(){var t=this.vertex;return new r([t.x,t.y,t.z])}});o.prototype.getXYZRef=o.prototype.getXYZ,o.prototype.setXYZRef=o.prototype.setXYZ}(e),function(t){var e=t.VertexPre3D;t.FaceProxy,t.MeshPre3D=t.Class(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var s,i,n=this.mesh.vertices,r=this.mesh.quads,h=n.length,o=(r.length,this.vertices);for(s=0;h>s;s++)i=new e(n[s]),o.push(i);return this.faces=null,this}})}(e),function(t){var e=t.Class(t.Library3d,{constructor:function(){this.id="pre3d.js",this.meshClass=t.MeshPre3D,this.vertexClass=t.VertexPre3D}});t.LibraryPre3D=new e}(e),e});
