/**
*
*   MOD3.js
*   @version: 0.3.5
*   @dependencies: Classy.js
*
*   MOD3 3D Modifier Library for JavaScript 
*   port of AS3DMod ActionScript3 library (http://code.google.com/p/as3dmod/)
*   https://github.com/foo123/MOD3
*
**/!function(t,i,s,n,e){s=s?[].concat(s):[];var r,h,o=Array,u=o.prototype,a=s.length,l=new o(a);if("object"==typeof module&&module.exports){if(e===module.exports[i]){for(r=0;a>r;r++)l[r]=module.exports[s[r][0]]||require(s[r][1])[s[r][0]];h=n.apply(t,l),module.exports[i]=h||1}}else if("function"==typeof define&&define.amd)define(["exports"].concat(s.map(function(t){return t[1]})),function(r){if(e===r[i]){var o,a=u.slice.call(arguments,1),c=a.length;for(o=0;c>o;o++)l[o]=r[s[o][0]]||a[o];h=n.apply(t,l),r[i]=h||1}});else if(e===t[i]){for(r=0;a>r;r++)l[r]=t[s[r][0]];h=n.apply(t,l),t[i]=h||1}}(this,"MOD3",[["Classy","./classy"]],function(t){var i=i||{VERSION:"0.3.5",Class:t.Class,StaticClass:t.Static};return function(t){t.Constants={PI:Math.PI,invPI:1/Math.PI,halfPI:.5*Math.PI,doublePI:2*Math.PI,toRad:Math.PI/180,toDeg:180/Math.PI},t.ModConstant={NONE:0,LEFT:-1,RIGHT:1,X:1,Y:2,Z:4,Xi:0,Yi:1,Zi:2},t.Array32F="undefined"!=typeof Float32Array?Float32Array:Array,t.Array64F="undefined"!=typeof Float64Array?Float64Array:Array,t.Array8I="undefined"!=typeof Int8Array?Int8Array:Array,t.Array16I="undefined"!=typeof Int16Array?Int16Array:Array,t.Array32I="undefined"!=typeof Int32Array?Int32Array:Array,t.Array8U="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Array16U="undefined"!=typeof Uint16Array?Uint16Array:Array,t.Array32U="undefined"!=typeof Uint32Array?Uint32Array:Array,t.VecArray=t.Array32F}(i),function(t,i){var s,n=t.Constants.toRad,e=t.Constants.toDeg,r=Math.min,h=Math.max,o=Math.pow,u=Math.round,a=Math.florr,l=Math.ceil,c=t.XMath=t.StaticClass({normalize:function(t,i,n){var e,r=i-t;return e=0===r?1:s(0,1,(n-t)/i)},toRange:function(t,i,s){var n,e=i-t;return n=0===e?0:t+(i-t)*s},inRange:function(t,s,n,e){return e===i&&(e=!1),e?n>=t&&s>=n:n>t&&s>n},sign:function(t,s){return s===i&&(s=0),0==t?s:t>0?1:-1},trim:function(t,i,s){return r(i,h(t,s))},wrap:function(t,i,s){var n=i-t;return t>s?s+n:s>=i?s-n:s},degToRad:function(t){return t*n},radToDeg:function(t){return t*e},presicion:function(t,i){var s=o(10,i);return u(t*s)/s},uceil:function(t){return 0>t?a(t):l(t)}});s=c.clamp=c.trim}(i),function(t,i){var s=t.XMath.normalize,n=t.XMath.toRange,e=t.XMath.trim;t.Range=t.Class(Object,{constructor:function(t,s){this.start=0,this.end=1,t!==i&&(this.start=t),s!==i&&(this.end=s)},start:0,end:1,dispose:function(){return this.start=null,this.end=null,this},getSize:function(){return this.end-this.start},move:function(t){this.start+=t,this.end+=t},isIn:function(t){return t>=this.start&&t<=this.end},normalize:function(t){return s(this.start,this.end,t)},toRange:function(t){return n(this.start,this.end,t)},trim:function(t){return e(this.start,this.end,t)},interpolate:function(t,i){return n(this.start,this.end,i.normalize(t))},toString:function(){return"["+this.start+" - "+this.end+"]"}})}(i),function(t,i){var s=Math.sin,n=Math.abs;t.Phase=t.Class(Object,{constructor:function(t){this.value=0,t!==i&&(this.value=t)},value:0,dispose:function(){return this.value=null,this},getPhasedValue:function(){return s(this.value)},getAbsPhasedValue:function(){return n(s(this.value))},getNormValue:function(){return.5*(s(this.value)+1)}})}(i),function(t,i){var s=t.Point=t.Class(Object,{constructor:function(t,s){this.x=t===i?0:t,this.y=s===i?0:s},x:0,y:0,dispose:function(){return this.x=null,this.y=null,this},clone:function(){return new s(this.x,this.y)}})}(i),function(t,i){var s=Math.sin,n=Math.cos,e=t.Point,r=t.Matrix=t.Class(Object,{constructor:function(t,s,n,e){this.m11=t===i?1:t,this.m12=s===i?0:s,this.m21=n===i?0:n,this.m22=e===i?1:e},m11:1,m12:0,m21:0,m22:1,dispose:function(){return this.m11=null,this.m12=null,this.m21=null,this.m22=null,this},reset:function(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this},rotate:function(t){var i=n(t),e=s(t);return this.m11=i,this.m12=-e,this.m21=e,this.m22=i,this},scale:function(t,s){return this.m12=0,this.m21=0,this.m11=1,this.m22=1,t!==i&&(this.m11=t,this.m22=t),s!==i&&(this.m22=s),this},multiply:function(t){var i=this.m11,s=this.m12,n=this.m21,e=this.m22,r=t.m11,h=t.m12,o=t.m21,u=t.m22;return this.m11=i*r+s*o,this.m12=i*h+s*u,this.m21=n*r+e*o,this.m22=n*h+e*u,this},transformPoint:function(t){var i=t.x,s=t.y,n=this.m11*i+this.m12*s,r=this.m21*i+this.m22*s;return new e(n,r)},transformPointSelf:function(t){var i=t.x,s=t.y;return t.x=this.m11*i+this.m12*s,t.y=this.m21*i+this.m22*s,t},clone:function(){return new r(this.m11,this.m12,this.m21,this.m22)}})}(i),function(t,i){var s=Math.sqrt,n=t.VecArray,e=t.Vector3=t.Class(Object,{__static__:{ZERO:function(){return new e([0,0,0])},dot:function(t,i){var s=t.xyz,n=i.xyz;return s[0]*n[0]+s[1]*n[1]+s[2]*n[2]},equals:function(t,i){var s=t.xyz,n=i.xyz;return s[0]==n[0]&&s[1]==n[1]&&s[2]==n[2]},cross:function(t,i){var s=t.xyz,n=i.xyz,r=s[0],h=s[1],o=s[2],u=n[0],a=n[1],l=n[2];return new e([h*l-o*a,o*u-r*l,r*a-h*u])},distance:function(t,i){var n=t.xyz,e=i.xyz,r=n[0]-e[0],h=n[1]-e[1],o=n[2]-e[2];return s(r*r+h*h+o*o)},sum:function(t,i){var s=t.xyz,n=i.xyz;return new e([s[0]+n[0],s[1]+n[1],s[2]+n[2]])}},constructor:function(t,s,e){t&&t.length?this.xyz=new n([t[0],t[1],t[2]]):(t=t===i?0:t,s=s===i?0:s,e=e===i?0:e,this.xyz=new n([t,s,e]))},xyz:null,dispose:function(){return this.xyz=null,this},getXYZ:function(){return new n(this.xyz)},getXYZRef:function(){return this.xyz},setXYZ:function(t){return this.xyz=new n(t),this},setXYZRef:function(t){return this.xyz=t,this},clone:function(){return new e(this.xyz)},equalsSelf:function(t){var i=this.xyz,s=t.xyz;return i[0]==s[0]&&i[1]==s[1]&&i[2]==s[2]},zeroSelf:function(){return this.xyz[0]=0,this.xyz[1]=0,this.xyz[2]=0,this},negate:function(){var t=this.xyz;return new e([-t[0],-t[1],-t[2]])},negateSelf:function(){var t=this.xyz;return t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],this},add:function(t){var i=this.xyz,s=t.xyz;return new e([i[0]+s[0],i[1]+s[1],i[2]+s[2]])},addSelf:function(t){var i=this.xyz,s=t.xyz;return i[0]+=s[0],i[1]+=s[1],i[2]+=s[2],this},subtract:function(t){var i=this.xyz,s=t.xyz;return new e([i[0]-s[0],i[1]-s[1],i[2]-s[2]])},subtractSelf:function(t){var i=this.xyz,s=t.xyz;return i[0]-=s[0],i[1]-=s[1],i[2]-=s[2],this},multiplyScalar:function(t){var i=this.xyz;return new e([i[0]*t,i[1]*t,i[2]*t])},multiplyScalarSelf:function(t){var i=this.xyz;return i[0]*=t,i[1]*=t,i[2]*=t,this},multiply:function(t){var i=this.xyz,s=t.xyz;return new e([i[0]*s[0],i[1]*s[1],i[2]*s[2]])},multiplySelf:function(t){var i=this.xyz,s=t.xyz;return i[0]*=s[0],i[1]*=s[1],i[2]*=s[2],this},divide:function(t){var i=1/t,s=this.xyz;return new e([s[0]*i,s[1]*i,s[2]*i])},divideSelf:function(t){var i=1/t,s=this.xyz;return s[0]*=i,s[1]*=i,s[2]*=i,this},normalize:function(){var t,i=this.xyz,n=i[0],r=i[1],h=i[2],o=n*n+r*r+h*h;return o>0&&(t=1/s(o),n*=t,r*=t,h*=t),new e([n,r,h])},normalizeSelf:function(){var t,i=this.xyz,n=i[0],e=i[1],r=i[2],h=n*n+e*e+r*r;return h>0&&(t=1/s(h),n*=t,e*=t,r*=t),i[0]=n,i[1]=e,i[2]=r,this},getMagnitude:function(){var t=this.xyz,i=t[0],n=t[1],e=t[2];return s(i*i+n*n+e*e)},setMagnitude:function(t){this.normalizeSelf();var i=this.xyz;return i[0]*=t,i[1]*=t,i[2]*=t,this},dotSelf:function(t){var i=this.xyz,s=t.xyz;return i[0]*s[0]+i[1]*s[1]+i[2]*s[2]},crossSelf:function(t){var i=this.xyz,s=t.xyz,n=i[0],e=i[1],r=i[2],h=s[0],o=s[1],u=s[2];return i[0]=e*u-r*o,i[1]=r*h-n*u,i[2]=n*o-e*h,this},distanceSelf:function(t){var i=this.xyz,n=t.xyz,e=i[0]-n[0],r=i[1]-n[1],h=i[2]-n[2];return s(e*e+r*r+h*h)},toString:function(){return"["+this.xyz[0]+" , "+this.xyz[1]+" , "+this.xyz[2]+"]"}})}(i),function(t,i){var s=Math.sin,n=Math.cos,e=t.Matrix4=t.Class(Object,{__static__:{multiplyVector:function(t,i){var s=i.xyz,n=s[0],e=s[1],r=s[2];return s[0]=n*t.n11+e*t.n12+r*t.n13+t.n14,s[1]=n*t.n21+e*t.n22+r*t.n23+t.n24,s[2]=n*t.n31+e*t.n32+r*t.n33+t.n34,i},calculateMultiply:function(t,i){var s=t.n11,n=i.n11,e=t.n21,r=i.n21,h=t.n31,o=i.n31,u=t.n12,a=i.n12,l=t.n22,c=i.n22,f=t.n32,d=i.n32,m=t.n13,x=i.n13,p=t.n23,y=i.n23,v=t.n33,g=i.n33,M=t.n14,w=i.n14,z=t.n24,A=i.n24,V=t.n34,b=i.n34;return t.n11=s*n+u*r+m*o,t.n12=s*a+u*c+m*d,t.n13=s*x+u*y+m*g,t.n14=s*w+u*A+m*b+M,t.n21=e*n+l*r+p*o,t.n22=e*a+l*c+p*d,t.n23=e*x+l*y+p*g,t.n24=e*w+l*A+p*b+z,t.n31=h*n+f*r+v*o,t.n32=h*a+f*c+v*d,t.n33=h*x+f*y+v*g,t.n34=h*w+f*A+v*b+V,t}},constructor:function(t,s,n,e,r,h,o,u,a,l,c,f,d,m,x,p){this.n11=t===i?1:t,this.n12=s===i?0:s,this.n13=n===i?0:n,this.n14=e===i?0:e,this.n21=r===i?0:r,this.n22=h===i?1:h,this.n23=o===i?0:o,this.n24=u===i?0:u,this.n31=a===i?0:a,this.n32=l===i?0:l,this.n33=c===i?1:c,this.n34=f===i?0:f,this.n41=d===i?0:d,this.n42=m===i?0:m,this.n43=x===i?0:x,this.n44=p===i?1:p},n11:1,n12:0,n13:0,n14:0,n21:0,n22:1,n23:0,n24:0,n31:0,n32:0,n33:1,n34:0,n41:0,n42:0,n43:0,n44:1,dispose:function(){return this.n11=null,this.n12=null,this.n13=null,this.n14=null,this.n21=null,this.n22=null,this.n23=null,this.n24=null,this.n31=null,this.n32=null,this.n33=null,this.n34=null,this.n41=null,this.n42=null,this.n43=null,this.n44=null,this},reset:function(){return this.n11=1,this.n12=0,this.n13=0,this.n14=0,this.n21=0,this.n22=1,this.n23=0,this.n24=0,this.n31=0,this.n32=0,this.n33=1,this.n34=0,this.n41=0,this.n42=0,this.n43=0,this.n44=1,this},translationMatrix:function(t,i,s){return this.n14=t,this.n24=i,this.n34=s,this},translationMatrixFromVector:function(t){var i=t.xyz;return this.n14=i[0],this.n24=i[1],this.n34=i[2],this},scaleMatrix:function(t,i,s){return this.n11=t,this.n22=i,this.n33=s,this},scaleMatrixFromVector:function(t){var i=t.xyz;return this.n11=i[0],this.n22=i[0],this.n33=i[0],this},rotationMatrix:function(t,i,e,r){var h=n(r),o=s(r),u=1-h,a=t*i*u,l=i*e*u,c=t*e*u,f=o*e,d=o*i,m=o*t;return this.n11=h+t*t*u,this.n12=-f+a,this.n13=d+c,this.n14=0,this.n21=f+a,this.n22=h+i*i*u,this.n23=-m+l,this.n24=0,this.n31=-d+c,this.n32=m+l,this.n33=h+e*e*u,this.n34=0,this},rotationMatrixFromVector:function(t,i){var e=t.xyz,r=e[0],h=e[1],o=e[2],u=n(i),a=s(i),l=1-u,c=r*h*l,f=h*o*l,d=r*o*l,m=a*o,x=a*h,p=a*r;return this.n11=u+r*r*l,this.n12=-m+c,this.n13=x+d,this.n14=0,this.n21=m+c,this.n22=u+h*h*l,this.n23=-p+f,this.n24=0,this.n31=-x+d,this.n32=p+f,this.n33=u+o*o*l,this.n34=0,this},multiply:function(t){return e.calculateMultiply(this,t),this},multiplyVector:function(t){var i=t.xyz,s=i[0],n=i[1],e=i[2];return i[0]=s*this.n11+n*this.n12+e*this.n13+this.n14,i[1]=s*this.n21+n*this.n22+e*this.n23+this.n24,i[2]=s*this.n31+n*this.n32+e*this.n33+this.n34,t}})}(i),function(t,i){var s=t.ModConstant,n=s.X,e=s.Y,r=s.Z,h=t.Vector3,o=t.VecArray;t.VertexProxy=t.Class(Object,{constructor:function(t){this.xyz=new o([0,0,0]),this.original=new o([0,0,0]),this.ratio=new o([0,0,0]),i!==t&&null!==t&&!1!==t&&this.setVertex(t)},vertex:null,xyz:null,original:null,ratio:null,dispose:function(){return this.vertex=null,this.xyz=null,this.original=null,this.ratio=null,this},setVertex:function(t){return this.vertex=t,this},getRatioVector:function(){return new h(this.ratio)},getRatio:function(t){switch(t){case n:return this.ratio[0];case e:return this.ratio[1];case r:return this.ratio[2]}return-1},getOriginalValue:function(t){switch(t){case n:return this.original[0];case e:return this.original[1];case r:return this.original[2]}return 0},setRatios:function(t,s,n){return t=t===i?0:t,s=s===i?0:s,n=n===i?0:n,this.ratio=new o([t,s,n]),this},setOriginalPosition:function(t,s,n){return t=t===i?0:t,s=s===i?0:s,n=n===i?0:n,this.original=new o([t,s,n]),this},getXYZ:function(){return new o(this.xyz)},getXYZRef:function(){return this.xyz},getX:function(){return this.xyz[0]},getY:function(){return this.xyz[1]},getZ:function(){return this.xyz[2]},setXYZ:function(t){return this.xyz=new o(t),this},setXYZRef:function(t){return this.xyz=t,this},setX:function(t){return this.xyz[0]=t,this},setY:function(t){return this.xyz[1]=t,this},setZ:function(t){return this.xyz[2]=t,this},getValue:function(t){switch(t){case n:return this.getX();case e:return this.getY();case r:return this.getZ()}return 0},setValue:function(t,i){switch(t){case n:this.setX(i);break;case e:this.setY(i);break;case r:this.setZ(i)}return this},reset:function(){return this.setXYZ(this.original),this},collapse:function(){return this.original=this.getXYZ(),this},getVector:function(){return new h(this.getXYZ())},setVector:function(t){this.setXYZ(t.xyz)}})}(i),function(t){t.FaceProxy=t.Class(Object,{constructor:function(){this.vertices=[]},vertices:null,dispose:function(){return this.vertices=null,this},addVertex:function(t){this.vertices.push(t)},getVertices:function(){return this.vertices}})}(i),function(t,i){var s=t.ModConstant,n=s.X,e=s.Y,r=s.Z,h=Math.min,o=Math.max;t.MeshProxy=t.Class(Object,{constructor:function(t){this.maxX=null,this.maxY=null,this.maxZ=null,this.minX=null,this.minY=null,this.minZ=null,this.maxAxis=null,this.midAxis=null,this.minAxis=null,this.width=null,this.height=null,this.depth=null,this.vertices=[],this.faces=[],this.mesh=null,i!==t&&this.setMesh(t)},maxX:null,maxY:null,maxZ:null,minX:null,minY:null,minZ:null,maxAxis:null,midAxis:null,minAxis:null,widht:null,height:null,depth:null,vertices:null,faces:null,mesh:null,dispose:function(){this.maxX=null,this.maxY=null,this.maxZ=null,this.minX=null,this.minY=null,this.minZ=null,this.maxAxis=null,this.midAxis=null,this.minAxis=null,this.widht=null,this.height=null,this.depth=null;var t,i;if(this.faces)for(i=this.faces.length,t=0;i>t;t++)this.faces[t].dispose();if(this.faces=null,this.vertices)for(i=this.vertices.length,t=0;i>t;t++)this.vertices[t].dispose();return this.vertices=null,this.mesh=null,this},setMesh:function(t){return this.mesh=t,this.vertices=[],this},getVertices:function(){return this.vertices},getFaces:function(){return this.faces},analyzeGeometry:function(){var t,i,s,u,a,l,c,f,d,m,x,p,y,v=this.vertices,g=v.length,M=g;for(g&&(t=v[0],i=t.getXYZ(),s=i[0],u=i[1],a=i[2],l=c=s,f=d=u,m=x=a);--M>=0;)t=v[M],i=t.getXYZ(),s=i[0],u=i[1],a=i[2],t.setOriginalPosition(s,u,a),l=h(l,s),f=h(f,u),m=h(m,a),c=o(c,s),d=o(d,u),x=o(x,a);p=c-l,y=d-f,depth=x-m,this.width=p,this.height=y,this.depth=depth,this.minX=l,this.maxX=c,this.minY=f,this.maxY=d,this.minZ=m,this.maxZ=x;var w=o(p,y,depth),z=h(p,y,depth);for(w==p&&z==y?(this.minAxis=e,this.midAxis=r,this.maxAxis=n):w==p&&z==depth?(this.minAxis=r,this.midAxis=e,this.maxAxis=n):w==y&&z==p?(this.minAxis=n,this.midAxis=r,this.maxAxis=e):w==y&&z==depth?(this.minAxis=r,this.midAxis=n,this.maxAxis=e):w==depth&&z==p?(this.minAxis=n,this.midAxis=e,this.maxAxis=r):w==depth&&z==y&&(this.minAxis=e,this.midAxis=n,this.maxAxis=r),M=g;--M>=0;)t=v[M],i=t.getXYZ(),t.setRatios((i[0]-l)/p,(i[1]-f)/y,(i[2]-m)/depth);return this},resetGeometry:function(){for(var t=this.vertices,i=t.length;--i>=0;)t[i].reset();return this.update(),this},collapseGeometry:function(){for(var t=this.vertices,i=t.length;--i>=0;)t[i].collapse();return this.update(),this.analyzeGeometry(),this},getMin:function(t){switch(t){case n:return this.minX;case e:return this.minY;case r:return this.minZ}return-1},getMax:function(t){switch(t){case n:return this.maxX;case e:return this.maxY;case r:return this.maxZ}return-1},getSize:function(t){switch(t){case n:return this.width;case e:return this.height;case r:return this.depth}return-1},update:function(){return this},postApply:function(){return this},updateMeshPosition:function(){return this}})}(i),function(t,i){var s=0,n=t.ModConstant.NONE;t.Modifier=t.Class(Object,{constructor:function(t){this.id=++s,this.name="Generic",this.mod=t||null,this.axes=n,this.constraint=n,this.enabled=!0},id:null,name:null,mod:null,axes:null,constraint:null,enabled:!0,dispose:function(){return this.mod=null,this.name=null,this.axes=null,this.constraint=null,this},enable:function(t){return i!==t?(this.enabled=!!t,this):this.enabled},constraintAxes:function(t){return this.axes=t||n,this},setConstraint:function(t){return this.constraint=t||n,this},setModifiable:function(t){return this.mod=t,this},getVertices:function(){return this.mod.getVertices()},apply:function(){return this},toString:function(){return"[Modifier "+this.name+"]"}})}(i),function(t){t.Library3d=t.Class(Object,{constructor:function(){this.id="",this.meshClass=null,this.vertexClass=null},id:"",meshClass:null,vertexClass:null})}(i),function(t){t.PluginFactory=t.StaticClass({getMeshProxy:function(t){var i=t.meshClass;return i?new i:null}})}(i),function(t){var i=t.PluginFactory.getMeshProxy,s=t.ModifierStack=t.Class(Object,{constructor:function(t,s){this.baseMesh=null,this.stack=[],this.lib3d=t,this.baseMesh=i(t),this.baseMesh.setMesh(s),this.baseMesh.analyzeGeometry()},lib3d:null,baseMesh:null,stack:null,dispose:function(t){if(this.lib3d=null,this.baseMesh.dispose(),this.baseMesh=null,t)for(;this.stack.length;)this.stack.pop().dispose();return this.stack=null,this},add:function(t){return t.setModifiable(this.baseMesh),this.stack.push(t),this},apply:function(){var t=this.stack,i=t.length,s=this.baseMesh,n=0;for(s.resetGeometry();i>n;)t[n].enabled&&t[n].apply(),n++;return s.update(),this},collapse:function(){return this.apply(),this.baseMesh.collapseGeometry(),this.stack.length=0,this},clear:function(){return this.stack.length=0,this},getMeshInfo:function(){return this.baseMesh}});s.prototype.addModifier=s.prototype.add}(i),function(t){function i(t,i,s){this.x=t,this.y=i,this.z=s}function s(t){return t*t*t*(t*(6*t-15)+10)}function n(t,i,s){return(1-s)*t+s*i}var e=t.noise={};i.prototype.dot2=function(t,i){return this.x*t+this.y*i},i.prototype.dot3=function(t,i,s){return this.x*t+this.y*i+this.z*s};var r=[new i(1,1,0),new i(-1,1,0),new i(1,-1,0),new i(-1,-1,0),new i(1,0,1),new i(-1,0,1),new i(1,0,-1),new i(-1,0,-1),new i(0,1,1),new i(0,-1,1),new i(0,1,-1),new i(0,-1,-1)],h=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],o=new Array(512),u=new Array(512);e.seed=function(t){t>0&&1>t&&(t*=65536),t=Math.floor(t),256>t&&(t|=t<<8);for(var i=0;256>i;i++){var s;s=1&i?h[i]^255&t:h[i]^255&t>>8,o[i]=o[i+256]=s,u[i]=u[i+256]=r[s%12]}},e.seed(0);var a=.5*(Math.sqrt(3)-1),l=(3-Math.sqrt(3))/6,c=1/3,f=1/6;e.simplex2=function(t,i){var s,n,e,r,h,c=(t+i)*a,f=Math.floor(t+c),d=Math.floor(i+c),m=(f+d)*l,x=t-f+m,p=i-d+m;x>p?(r=1,h=0):(r=0,h=1);var y=x-r+l,v=p-h+l,g=x-1+2*l,M=p-1+2*l;f&=255,d&=255;var w=u[f+o[d]],z=u[f+r+o[d+h]],A=u[f+1+o[d+1]],V=.5-x*x-p*p;0>V?s=0:(V*=V,s=V*V*w.dot2(x,p));var b=.5-y*y-v*v;0>b?n=0:(b*=b,n=b*b*z.dot2(y,v));var C=.5-g*g-M*M;return 0>C?e=0:(C*=C,e=C*C*A.dot2(g,M)),70*(s+n+e)},e.simplex3=function(t,i,s){var n,e,r,h,a,l,d,m,x,p,y=(t+i+s)*c,v=Math.floor(t+y),g=Math.floor(i+y),M=Math.floor(s+y),w=(v+g+M)*f,z=t-v+w,A=i-g+w,V=s-M+w;z>=A?A>=V?(a=1,l=0,d=0,m=1,x=1,p=0):z>=V?(a=1,l=0,d=0,m=1,x=0,p=1):(a=0,l=0,d=1,m=1,x=0,p=1):V>A?(a=0,l=0,d=1,m=0,x=1,p=1):V>z?(a=0,l=1,d=0,m=0,x=1,p=1):(a=0,l=1,d=0,m=1,x=1,p=0);var b=z-a+f,C=A-l+f,X=V-d+f,Z=z-m+2*f,Y=A-x+2*f,P=V-p+2*f,S=z-1+3*f,R=A-1+3*f,I=V-1+3*f;v&=255,g&=255,M&=255;var $=u[v+o[g+o[M]]],F=u[v+a+o[g+l+o[M+d]]],O=u[v+m+o[g+x+o[M+p]]],k=u[v+1+o[g+1+o[M+1]]],N=.5-z*z-A*A-V*V;0>N?n=0:(N*=N,n=N*N*$.dot3(z,A,V));var T=.5-b*b-C*C-X*X;0>T?e=0:(T*=T,e=T*T*F.dot3(b,C,X));var U=.5-Z*Z-Y*Y-P*P;0>U?r=0:(U*=U,r=U*U*O.dot3(Z,Y,P));var j=.5-S*S-R*R-I*I;return 0>j?h=0:(j*=j,h=j*j*k.dot3(S,R,I)),32*(n+e+r+h)},e.perlin2=function(t,i){var e=Math.floor(t),r=Math.floor(i);t-=e,i-=r,e=255&e,r=255&r;var h=u[e+o[r]].dot2(t,i),a=u[e+o[r+1]].dot2(t,i-1),l=u[e+1+o[r]].dot2(t-1,i),c=u[e+1+o[r+1]].dot2(t-1,i-1),f=s(t);return n(n(h,l,f),n(a,c,f),s(i))},e.perlin3=function(t,i,e){var r=Math.floor(t),h=Math.floor(i),a=Math.floor(e);t-=r,i-=h,e-=a,r=255&r,h=255&h,a=255&a;var l=u[r+o[h+o[a]]].dot3(t,i,e),c=u[r+o[h+o[a+1]]].dot3(t,i,e-1),f=u[r+o[h+1+o[a]]].dot3(t,i-1,e),d=u[r+o[h+1+o[a+1]]].dot3(t,i-1,e-1),m=u[r+1+o[h+o[a]]].dot3(t-1,i,e),x=u[r+1+o[h+o[a+1]]].dot3(t-1,i,e-1),p=u[r+1+o[h+1+o[a]]].dot3(t-1,i-1,e),y=u[r+1+o[h+1+o[a+1]]].dot3(t-1,i-1,e-1),v=s(t),g=s(i),M=s(e);return n(n(n(l,m,v),n(c,x,v),M),n(n(f,p,v),n(d,y,v),M),g)}}(this),function(t){var i=t.Vector3;t.Pivot=t.Class(t.Modifier,{constructor:function(t,s,n){this.$super("constructor"),this.name="Pivot",this.pivot=new i([t,s,n])},pivot:null,dispose:function(){return this.pivot.dispose(),this.pivot=null,this.$super("dispose"),this},setMeshCenter:function(){var t=this.mod;return this.pivot=new i(-(t.minX+.5*t.width),-(t.minY+.5*t.height),-(t.minZ+.5*t.depth)),this},apply:function(){for(var t,i=this.mod.vertices,s=i.length,n=this.pivot;--s>=0;)t=i[s],t.setVector(t.getVector().addSelf(n));return this.mod.updateMeshPosition(n.negate()),this}})}(i),function(t,i){var s=t.ModConstant.NONE,n=t.ModConstant.LEFT,e=t.ModConstant.RIGHT,r=t.Matrix,h=Math.atan,o=(Math.atan2,Math.sin),u=Math.cos,a=t.Constants.PI,l=t.Constants.halfPI,c=t.Constants.doublePI,f=t.Point;t.Bend=t.Class(t.Modifier,{constructor:function(t,n,e){this.$super("constructor"),this.name="Bend",this.constraint=s,this.max=0,this.min=0,this.mid=0,this.width=0,this.height=0,this.origin=0,this.m1=null,this.m2=null,this.diagAngle=0,this.switchAxes=!1,this.force=t!==i?t:0,this.offset=n!==i?n:0,e!==i?this.setAngle(e):this.setAngle(0)},force:0,offset:0,angle:0,diagAngle:0,max:0,min:0,mid:0,width:0,height:0,origin:0,m1:null,m2:null,switchAxes:!1,dispose:function(){return this.force=null,this.offset=null,this.angle=null,this.diagAngle=null,this.max=null,this.min=null,this.mid=null,this.width=null,this.height=null,this.origin=null,this.m1&&this.m1.dispose(),this.m2&&this.m2.dispose(),this.m1=null,this.m2=null,this.switchAxes=null,this.$super("dispose"),this},setAngle:function(t){return this.angle=t,this.m1=(new r).rotate(t),this.m2=(new r).rotate(-t),this},setModifiable:function(t){return this.$super("setModifiable",t),this.max=this.switchAxes?this.mod.midAxis:this.mod.maxAxis,this.min=this.mod.minAxis,this.mid=this.switchAxes?this.mod.maxAxis:this.mod.midAxis,this.width=this.mod.getSize(this.max),this.height=this.mod.getSize(this.mid),this.origin=this.mod.getMin(this.max),this.diagAngle=h(this.width/this.height),this},apply:function(){if(!this.force)return this;for(var t,i,s,r,h,d,m,x,p,y,v=this.mod.vertices,g=v.length,M=this.constraint,w=this.width,z=this.offset,A=this.origin,V=this.force,b=this.max,C=this.min,X=this.mid,Z=this.m1,Y=this.m2,P=A+w*z,S=w/a/V,R=c*(w/(S*c)),I=1/w;--g>=0;)t=v[g],i=t.getValue(b),s=t.getValue(X),r=t.getValue(C),h=Z.transformPointSelf(new f(i,s)),i=h.x,s=h.y,d=(i-A)*I,n===M&&z>=d||e===M&&d>=z||(m=l-R*z+R*d,x=o(m)*(S+r),p=u(m)*(S+r),r=x-S,i=P-p),y=Y.transformPointSelf(new f(i,s)),i=y.x,s=y.y,t.setValue(b,i),t.setValue(X,s),t.setValue(C,r);return this}})}(i),function(t){var i=t.Vector3,s=Math.max,n=Math.exp;t.Bloat=t.Class(t.Modifier,{constructor:function(){this.$super("constructor"),this.name="Bloat",this.radius=0,this.a=.01,this.center=i.ZERO()},center:null,radius:0,a:.01,dispose:function(){return this.center.dispose(),this.center=null,this.radius=null,this.a=null,this.$super("dispose"),this},setRadius:function(t){return this.radius=s(0,t),this},setA:function(t){return this.a=s(0,t),this},apply:function(){for(var t,i,s,e=this.mod.vertices,r=e.length,h=this.center,o=this.radius,u=this.a;--r>=0;)t=e[r],s=t.getVector().subtractSelf(h),i=s.getMagnitude(),s.setMagnitude(i+o*n(-i*u)),t.setVector(s.addSelf(h));return this}})}(i),function(t,i){var s=t.Vector3,n=t.Matrix4;t.Twist=t.Class(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Twist",this.vector=new s([0,1,0]).normalizeSelf(),this.angle=t!==i?t:0,this.center=s.ZERO(),this.mat1=new n,this.mat2=new n},vector:null,angle:0,center:null,mat1:null,mat2:null,dispose:function(){return this.vector.dispose(),this.vector=null,this.angle=null,this.center.dispose(),this.center=null,this.mat1.dispose(),this.mat2.dispose(),this.mat1=null,this.mat2=null,this.$super("dispose"),this},apply:function(){for(var t,i,n,e=this.mod,r=e.vertices,h=r.length,o=this.vector,u=this.angle,a=this.center,l=new s([.5*e.maxX,.5*e.maxY,.5*e.maxZ]),c=1/l.getMagnitude(),f=c*u,d=-s.dot(o,a);--h>=0;)t=r[h],n=t.getVector(),i=s.dot(n,o)+d,t.setVector(this.twistPoint(n,o,i*f));return this},twistPoint:function(t,i,n){var e=this.mat1.reset().translationMatrixFromVector(t),r=this.mat2.reset().rotationMatrixFromVector(i,n);return r.multiply(e),new s([r.n14,r.n24,r.n34])}})}(i),function(t,i){var s=Math.abs,n=Math.pow,e=(t.XMath.sign,t.ModConstant),r=e.NONE,h=e.LEFT,o=e.RIGHT,u=e.X,a=e.Y,l=e.Z;t.Skew=t.Class(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Skew",this.force=t!==i?t:0,this.offset=.5,this.constraint=r,this.power=1,this.falloff=1,this.inverseFalloff=!1,this.oneSide=!1,this.swapAxes=!1,this.skewAxis=0},force:0,skewAxis:0,offset:.5,power:1,falloff:1,inverseFalloff:!1,oneSide:!1,swapAxes:!1,dispose:function(){return this.force=null,this.skewAxis=null,this.offset=null,this.power=null,this.falloff=null,this.inverseFalloff=null,this.oneSide=null,this.swapAxes=null,this.$super("dispose"),this},setModifiable:function(t){return this.$super("setModifiable",t),this.skewAxis=this.skewAxis||this.mod.maxAxis,this},apply:function(){for(var t,i,e,r,u,a,l,c,f=this.mod.vertices,d=f.length,m=this.constraint,x=this.skewAxis,p=this.offset,y=this.oneSide,v=this.inverseFalloff,g=this.falloff,M=1-g,w=this.power,z=this.force,A=this.getDisplaceAxis();--d>=0;)t=f[d],l=t.getRatio(x),h===m&&p>=l||o===m&&l>p||(i=l-p,y&&(i=s(i)),e=t.getRatio(A),v&&(e=1-e),r=g+e*M,c=0>i?-1:1,u=n(s(i),w)*c,a=t.getValue(A)+z*u*r,t.setValue(A,a));return this},getDisplaceAxis:function(){var t=this.skewAxis,i=this.swapAxes;switch(t){case u:return i?l:a;case a:return i?l:u;case l:return i?a:u}}})}(i),function(t,i){var s=t.Vector3,n=t.Matrix4,e=Math.pow;t.Taper=t.Class(t.Modifier,{constructor:function(t,n){this.$super("constructor"),this.name="Taper",this.vector=new s([1,0,1]),this.vector2=new s([0,1,0]),this.force=t!==i?t:0,this.power=n!==i?n:1},force:0,power:1,vector:null,vector2:null,dispose:function(){return this.vector.dispose(),this.vector2.dispose(),this.vector=null,this.vector2=null,this.force=null,this.power=null,this.$super("dispose"),this},apply:function(){var t,i,s,r,h,o,u=this.mod.vertices,a=u.length,l=this.vector,c=this.vector2,f=this.force,d=this.power;for(r=new n;--a>=0;)t=u[a],i=t.getRatioVector().multiply(c),s=1!==d?f*e(i.getMagnitude(),d):f*i.getMagnitude(),o=l.xyz,r.reset().scaleMatrix(1+s*o[0],1+s*o[1],1+s*o[2]),h=t.getVector(),t.setVector(r.multiplyVector(h));return this}})}(i),function(t){var i=t.Constants.invPI,s=t.Constants.doublePI,n=t.Vector3,e=t.Matrix4;t.Wheel=t.Class(t.Modifier,{constructor:function(){this.$super("constructor"),this.name="Wheel",this.speed=0,this.turn=0,this.roll=0,this.radius=0,this.steerVector=new n([0,1,0]),this.rollVector=new n([0,0,1])},speed:0,turn:0,roll:0,radius:0,steerVector:null,rollVector:null,dispose:function(){return this.speed=null,this.turn=null,this.roll=null,this.radius=null,this.steerVector.dispose(),this.rollVector.dispose(),this.steerVector=null,this.rollVector=null,this.$super("dispose"),this},setModifiable:function(t){return this.$super("setModifiable",t),this.radius=.5*this.mod.width,this},apply:function(){var t,i,s=this.mod.vertices,n=s.length,r=this.steerVector,h=this.turn,o=this.rollVector,u=this.roll,a=null,l=null,c=null;for(this.roll+=this.speed,h?(l=(new e).rotationMatrixFromVector(r,h),c=l.multiplyVector(o.clone()),a=(new e).rotationMatrixFromVector(c,u)):a=(new e).rotationMatrixFrom(o,u);--n>=0;)t=s[n],i=t.getVector(),l&&l.multiplyVector(i),t.setVector(a.multiplyVector(i));return this},getStep:function(){return this.radius*this.speed*i},getPerimeter:function(){return this.radius*s}})}(i),function(t,i){var s=t.Vector3,n=t.Range,e=t.Matrix4;t.Break=t.Class(t.Modifier,{constructor:function(t,e){this.$super("constructor"),this.name="Break",this.bv=new s([0,1,0]),this.range=new n(0,1),this.offset=t!==i?t:0,this.angle=e!==i?e:0},bv:null,range:null,offset:0,angle:0,dispose:function(){return this.bv.dispose(),this.bv=null,this.range.dispose(),this.range=null,this.offset=null,this.angle=null,this.$super("dispose"),this},apply:function(){var t,i,n,r,h,o=this.mod,u=o.vertices,a=u.length,l=this.offset,c=this.range,f=this.angle,d=this.bv,m=d.xyz;for(t=new s([0,0,-(o.minZ+o.depth*l)]),i=t.negate(),h=(new e).rotationMatrix(m[0],m[1],m[2],f);--a>=0;)n=u[a],r=n.getVector().addSelf(t),r.xyz[2]>=0&&c.isIn(n.ratio[1])&&h.multiplyVector(r),n.setVector(r.addSelf(i));return this}})}(i),function(t,i){var s=t.ModConstant.NONE,n=t.ModConstant.X,e=t.ModConstant.Y,r=t.ModConstant.Z,h=(t.VecArray,Math.random);t.Noise=t.Class(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Noise",this.axes=s,this.start=0,this.end=0,this.force=t!==i?t:0},force:0,start:0,end:1,dispose:function(){return this.force=null,this.start=null,this.end=null,this.$super("dispose"),this},setFalloff:function(t,s){return this.start=t!==i?t:0,this.end=s!==i?s:1,this},apply:function(){for(var t,i,s,o,u,a=this.mod,l=this.axes,c=this.start,f=this.end,d=a.vertices,m=d.length,x=this.force,p=.5*x,y=a.maxAxis;--m>=0;)t=d[m],i=h()*x-p,s=t.getRatio(y),f>c?c>s?s=0:s>f&&(s=1):c>f?(s=1-s,s>c?s=0:f>s&&(s=1)):s=1,o=i*s,u=t.getXYZ(),t.setXYZ([u[0]+(l&n?0:o),u[1]+(l&e?0:o),u[2]+(l&r?0:o)]);return this}})}(i),function(t){var i=Math.round,s=t.ModConstant,n=(s.NONE,s.X),e=s.Y,r=s.Z;t.DisplaceMap=t.Class(t.Modifier,{constructor:function(t,i,s,h){this.$super("constructor"),this.name="DisplaceMap",this.setBitmap(t,i,s),this.force=h||1,this.offset=128,this.axes=n|e|r},width:null,height:null,bitmap:null,force:1,offset:128,dispose:function(){return this.bitmap=null,this.width=null,this.height=null,this.force=null,this.offset=null,this.$super("dispose"),this},setBitmap:function(t,i,s){return this.bitmap=t||null,this.width=i||0,this.height=s||0,this},getUVPixel:function(t,s){var n=this.width,e=this.height,r=i((n-1)*t),h=i((e-1)*s);return this.bitmap[h%e*n+r%n]},apply:function(){for(var t,i,s,h=this.mod.vertices,o=h.length,u=this.axes,a=this.force,l=this.offset;--o>=0;)t=h[o],s=t.getXYZ(),i=this.getUVPixel(t.ratio[0],t.ratio[2]),u&n&&(s[0]+=((255&i>>16)-l)*a),u&e&&(s[1]+=((255&i>>8)-l)*a),u&r&&(s[2]+=((255&i)-l)*a),t.setXYZ(s);return this}})}(i),function(t,i){var s=(t.Vector3,Math.round),n=t.VecArray,e=t.ModConstant,r=(e.NONE,e.X),h=e.Y,o=e.Z,u=t.PerlinNoise=t.Class(Object,{constructor:function(t,n){this.width=i!==t?s(t):10,this.height=i!==n?s(n):10},width:10,height:10,data:null,dispose:function(){return this.data=null,this.width=this.height=null,this},generate:function(){var t,i,s,e=this.width,r=this.height,h=e*r,o=new n(h);for(t=0,i=0,s=0;h>s;s++,i++)i>=r&&(i=0,t++),o[s]=noise.simplex2(t/e,i/r);return this.data=o,this},move:function(t,i){var e,r,h,o=this.width,u=this.height,a=o*u,l=this.data,c=new n(a);for(t=s(t),i=s(i),0>t&&(t+=o),0>i&&(i+=u),e=0,r=0,h=0;a>e;h++,r++)r>=u&&(r=0,e++),c[h]=l[(e+t)%o*u+(r+i)%u];return this.data=c,this}});t.Perlin=t.Class(t.Modifier,{constructor:function(t,s,n){this.$super("constructor"),this.name="Perlin",this.source=i===s?new u(25,25).generate():s,this.force=t||1,this.autoRun=i!==n?!!n:!0,this.axes=r|h|o},speedX:1,speedY:1,source:null,force:1,offset:0,autoRun:!0,dispose:function(){return this.source=null,this.force=null,this.offset=null,this.autoRun=null,this.$super("dispose"),this},getUVValue:function(t,i){var n=this.source.width,e=this.source.height,r=s((n-1)*t),h=s((e-1)*i);return this.source.data[r%n*e+h%e]
},apply:function(){var t,i,s,n=this.mod.vertices,e=n.length,u=this.axes,a=this.force,l=this.offset;for(this.autoRun&&this.source.move(this.speedX,this.speedY);--e>=0;)t=n[e],s=t.getXYZ(),i=this.getUVValue(t.ratio[0],t.ratio[2]),i=(i-l)*a,u&r&&(s[0]+=i),u&h&&(s[1]+=i),u&o&&(s[2]+=i),t.setXYZ(s);return this}})}(i),function(t){var i=t.ModConstant,s=i.X,n=i.Y,e=i.Z,r=t.Vector3,h=t.VecArray,o=t.VertexThree=t.Class(t.VertexProxy,{constructor:function(t,i){this.mesh=t,this.$super("constructor",i)},mesh:null,dispose:function(){return this.mesh=null,this.$super("dispose"),this},setVertex:function(t){return this.vertex=t,this.original=new h([t.x,t.y,t.z]),this.xyz=new h(this.original),this},getXYZ:function(){var t=this.vertex;return new h([t.x,t.y,t.z])},getX:function(){return this.vertex.x},getY:function(){return this.vertex.y},getZ:function(){return this.vertex.z},setXYZ:function(t){var i=this.vertex;return this.mesh.geometry,i.x=t[0],i.y=t[1],i.z=t[2],this},setX:function(t){var i=this.vertex;return i.x=t,this},setY:function(t){var i=this.vertex;return i.y=t,this},setZ:function(t){var i=this.vertex;return i.z=t,this},reset:function(){var t=this.vertex,i=(this.mesh.geometry,this.original);return t.x=i[0],t.y=i[1],t.z=i[2],this},collapse:function(){var t=this.vertex;return this.original=new h([t.x,t.y,t.z]),this},getValue:function(t){var i=this.vertex;switch(t){case s:return i.x;case n:return i.y;case e:return i.z}return 0},setValue:function(t,i){var r=this.vertex,h=!1;switch(t){case s:r.x=i,h=!0;break;case n:r.y=i,h=!0;break;case e:r.z=i,h=!0}return this},setVector:function(t){var i=this.vertex,s=t.xyz;return this.mesh.geometry,i.x=s[0],i.y=s[1],i.z=s[2],this},getVector:function(){var t=this.vertex;return new r([t.x,t.y,t.z])}});o.prototype.getXYZRef=o.prototype.getXYZ,o.prototype.setXYZRef=o.prototype.setXYZ}(i),function(t){var i=t.VertexThree;t.FaceProxy,t.MeshThree=t.Class(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var s,n=0,t=this.mesh,e=this.vertices,r=t.geometry.vertices,h=r.length,o=t.geometry.faces;for(o.length,n=0;h>n;)s=new i(t,r[n]),e.push(s),n++;return this.faces=null,this},update:function(){var t=this.mesh.geometry;return t.verticesNeedUpdate=!0,t.normalsNeedUpdate=!0,t.buffersNeedUpdate=!0,t.dynamic=!0,this},updateMeshPosition:function(t){var i=this.mesh.position,s=t.xyz;return i.x+=s[0],i.y+=s[1],i.z+=s[2],this}})}(i),function(t){var i=t.Class(t.Library3d,{constructor:function(){this.id="Three.js",this.meshClass=t.MeshThree,this.vertexClass=t.VertexThree}});t.LibraryThree=new i}(i),i});