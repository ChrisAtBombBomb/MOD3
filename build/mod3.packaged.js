/**
*
*   MOD3.js
*   @version: 0.3.2
*
*   MOD3 3D Modifier Library for JavaScript 
*   port of AS3DMod ActionScript3 library (http://code.google.com/p/as3dmod/)
*   https://github.com/foo123/MOD3
*
**/!function(t,e,i,n,r){i=i?[].concat(i):[];var s,h=Array,o=h.prototype,a=i.length,u=new h(a),c=new h(a),f=new h(a);for(s=0;a>s;s++)u[s]=i[s][0],c[s]=i[s][1];if("object"==typeof module&&module.exports){if(r===module.exports[e]){for(s=0;a>s;s++)f[s]=module.exports[u[s]]||require(c[s])[u[s]];module.exports[e]=n.apply(t,f)}}else if("function"==typeof define&&define.amd)define(["exports"].concat(c),function(i){if(r===i[e]){for(var s=o.slice.call(arguments,1),h=s.length,a=0;h>a;a++)f[a]=i[u[a]]||s[a];i[e]=n.apply(t,f)}});else if(r===t[e]){for(s=0;a>s;s++)f[s]=t[u[s]];t[e]=n.apply(t,f)}}(this,"MOD3",[["Classy","./classy"]],function(t){var e=t.Class,i=i||{VERSION:"0.3.2"};return function(t){t.Constants={PI:Math.PI,invPI:1/Math.PI,halfPI:.5*Math.PI,doublePI:2*Math.PI,toRad:Math.PI/180,toDeg:180/Math.PI},t.ModConstant={LEFT:-1,RIGHT:1,NONE:0,X:1,Y:2,Z:4},t.Array32F="undefined"!=typeof Float32Array?Float32Array:Array,t.Array64F="undefined"!=typeof Float64Array?Float64Array:Array,t.Array8I="undefined"!=typeof Int8Array?Int8Array:Array,t.Array16I="undefined"!=typeof Int16Array?Int16Array:Array,t.Array32I="undefined"!=typeof Int32Array?Int32Array:Array,t.Array8U="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Array16U="undefined"!=typeof Uint16Array?Uint16Array:Array,t.Array32U="undefined"!=typeof Uint32Array?Uint32Array:Array,t.VecArray=t.Array32F}(i),function(t,e){var i,n=t.Constants.toRad,r=t.Constants.toDeg,s=Math.min,h=Math.max,o=Math.pow,a=Math.round,u=Math.florr,c=Math.ceil,f=t.XMath={normalize:function(t,e,n){var r,s=e-t;return r=0==s?1:i(0,1,(n-t)/e)},toRange:function(t,e,i){var n,r=e-t;return n=0==r?0:t+(e-t)*i},inRange:function(t,i,n,r){return r===e&&(r=!1),r?n>=t&&i>=n:n>t&&i>n},sign:function(t,i){return i===e&&(i=0),0==t?i:t>0?1:-1},trim:function(t,e,i){return s(e,h(t,i))},wrap:function(t,e,i){var n=e-t;return t>i?i+n:i>=e?i-n:i},degToRad:function(t){return t*n},radToDeg:function(t){return t*r},presicion:function(t,e){var i=o(10,e);return a(t*i)/i},uceil:function(t){return 0>t?u(t):c(t)}};i=f.clamp=f.trim}(i),function(t,i){var n=t.XMath.normalize,r=t.XMath.toRange,s=t.XMath.trim;t.Range=e(Object,{constructor:function(t,e){this.start=0,this.end=1,t!==i&&(this.start=t),e!==i&&(this.end=e)},start:0,end:1,getSize:function(){return this.end-this.start},move:function(t){this.start+=t,this.end+=t},isIn:function(t){return t>=this.start&&t<=this.end},normalize:function(t){return n(this.start,this.end,t)},toRange:function(t){return r(this.start,this.end,t)},trim:function(t){return s(this.start,this.end,t)},interpolate:function(t,e){return r(this.start,this.end,e.normalize(t))},toString:function(){return"["+this.start+" - "+this.end+"]"}})}(i),function(t,i){var n=Math.sin,r=Math.abs;t.Phase=e(Object,{constructor:function(t){this.value=0,t!==i&&(this.value=t)},value:0,getPhasedValue:function(){return n(this.value)},getAbsPhasedValue:function(){return r(n(this.value))},getNormValue:function(){return.5*(n(this.value)+1)}})}(i),function(t,i){var n=t.Point=e(Object,{constructor:function(t,e){this.x=t===i?0:t,this.y=e===i?0:e},x:0,y:0,clone:function(){return new n(this.x,this.y)}})}(i),function(t,i){var n=Math.sin,r=Math.cos,s=t.Point,h=t.Matrix=e(Object,{constructor:function(t,e,n,r){this.m11=t===i?1:t,this.m12=e===i?0:e,this.m21=n===i?0:n,this.m22=r===i?1:r},m11:1,m12:0,m21:0,m22:1,reset:function(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this},rotate:function(t){var e=r(t),i=n(t);return this.m11=e,this.m12=-i,this.m21=i,this.m22=e,this},scale:function(t,e){return this.m12=0,this.m21=0,t!==i&&(this.m11=t,this.m22=t),e!==i&&(this.m22=e),this},multiply:function(t){var e=this.m11,i=this.m12,n=this.m21,r=this.m22,s=t.m11,h=t.m12,o=t.m21,a=t.m22;return this.m11=e*s+i*o,this.m12=e*h+i*a,this.m21=n*s+r*o,this.m22=n*h+r*a,this},transformPoint:function(t){var e=t.x,i=t.y,n=this.m11*e+this.m12*i,r=this.m21*e+this.m22*i;return new s(n,r)},transformPointSelf:function(t){var e=t.x,i=t.y;return t.x=this.m11*e+this.m12*i,t.y=this.m21*e+this.m22*i,t},clone:function(){return new h(this.m11,this.m12,this.m21,this.m22)}})}(i),function(t,i){var n=Math.sqrt,r=t.VecArray,s=t.Vector3=e(Object,{constructor:function(t,e,n){t&&t.length?this.xyz=new r([t[0],t[1],t[2]]):(t=t===i?0:t,e=e===i?0:e,n=n===i?0:n,this.xyz=new r([t,e,n]))},xyz:null,getXYZ:function(){return new r(this.xyz)},getXYZRef:function(){return this.xyz},setXYZ:function(t){return this.xyz=new r(t),this},setXYZRef:function(t){return this.xyz=t,this},clone:function(){return new s(this.xyz)},equalsSelf:function(t){var e=this.xyz,i=t.xyz;return e[0]==i[0]&&e[1]==i[1]&&e[2]==i[2]},zeroSelf:function(){return this.xyz[0]=0,this.xyz[1]=0,this.xyz[2]=0,this},negate:function(){var t=this.xyz;return new s([-t[0],-t[1],-t[2]])},negateSelf:function(){var t=this.xyz;return t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],this},add:function(t){var e=this.xyz,i=t.xyz;return new s([e[0]+i[0],e[1]+i[1],e[2]+i[2]])},addSelf:function(t){var e=this.xyz,i=t.xyz;return e[0]+=i[0],e[1]+=i[1],e[2]+=i[2],this},subtract:function(t){var e=this.xyz,i=t.xyz;return new s([e[0]-i[0],e[1]-i[1],e[2]-i[2]])},subtractSelf:function(t){var e=this.xyz,i=t.xyz;return e[0]-=i[0],e[1]-=i[1],e[2]-=i[2],this},multiplyScalar:function(t){var e=this.xyz;return new s([e[0]*t,e[1]*t,e[2]*t])},multiplyScalarSelf:function(t){var e=this.xyz;return e[0]*=t,e[1]*=t,e[2]*=t,this},multiply:function(t){var e=this.xyz,i=t.xyz;return new s([e[0]*i[0],e[1]*i[1],e[2]*i[2]])},multiplySelf:function(t){var e=this.xyz,i=t.xyz;return e[0]*=i[0],e[1]*=i[1],e[2]*=i[2],this},divide:function(t){var e=1/t,i=this.xyz;return new s([i[0]*e,i[1]*e,i[2]*e])},divideSelf:function(t){var e=1/t,i=this.xyz;return i[0]*=e,i[1]*=e,i[2]*=e,this},normalize:function(){var t,e=this.xyz,i=e[0],r=e[1],h=e[2],o=i*i+r*r+h*h;return o>0&&(t=1/n(o),i*=t,r*=t,h*=t),new s([i,r,h])},normalizeSelf:function(){var t,e=this.xyz,i=e[0],r=e[1],s=e[2],h=i*i+r*r+s*s;return h>0&&(t=1/n(h),i*=t,r*=t,s*=t),e[0]=i,e[1]=r,e[2]=s,this},getMagnitude:function(){var t=this.xyz,e=t[0],i=t[1],r=t[2];return n(e*e+i*i+r*r)},setMagnitude:function(t){this.normalizeSelf();var e=this.xyz;return e[0]*=t,e[1]*=t,e[2]*=t,this},dotSelf:function(t){var e=this.xyz,i=t.xyz;return e[0]*i[0]+e[1]*i[1]+e[2]*i[2]},crossSelf:function(t){var e=this.xyz,i=t.xyz,n=e[0],r=e[1],s=e[2],h=i[0],o=i[1],a=i[2];return e[0]=r*a-s*o,e[1]=s*h-n*a,e[2]=n*o-r*h,this},distanceSelf:function(t){var e=this.xyz,i=t.xyz,r=e[0]-i[0],s=e[1]-i[1],h=e[2]-i[2];return n(r*r+s*s+h*h)},toString:function(){return"["+this.xyz[0]+" , "+this.xyz[1]+" , "+this.xyz[2]+"]"}});s.ZERO=function(){return new s([0,0,0])},s.dot=function(t,e){var i=t.xyz,n=e.xyz;return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]},s.equals=function(t,e){var i=t.xyz,n=e.xyz;return i[0]==n[0]&&i[1]==n[1]&&i[2]==n[2]},s.cross=function(t,e){var i=t.xyz,n=e.xyz,r=i[0],h=i[1],o=i[2],a=n[0],u=n[1],c=n[2];return new s([h*c-o*u,o*a-r*c,r*u-h*a])},s.distance=function(t,e){var i=t.xyz,r=e.xyz,s=i[0]-r[0],h=i[1]-r[1],o=i[2]-r[2];return n(s*s+h*h+o*o)},s.sum=function(t,e){var i=t.xyz,n=e.xyz;return new s([i[0]+n[0],i[1]+n[1],i[2]+n[2]])}}(i),function(t,i){var n,r,s=Math.sin,h=Math.cos,o=t.Matrix4=e(Object,{constructor:function(t,e,n,r,s,h,o,a,u,c,f,l,x,y,m,v){this.n11=t===i?1:t,this.n12=e===i?0:e,this.n13=n===i?0:n,this.n14=r===i?0:r,this.n21=s===i?0:s,this.n22=h===i?1:h,this.n23=o===i?0:o,this.n24=a===i?0:a,this.n31=u===i?0:u,this.n32=c===i?0:c,this.n33=f===i?1:f,this.n34=l===i?0:l,this.n41=x===i?0:x,this.n42=y===i?0:y,this.n43=m===i?0:m,this.n44=v===i?1:v},n11:1,n12:0,n13:0,n14:0,n21:0,n22:1,n23:0,n24:0,n31:0,n32:0,n33:1,n34:0,n41:0,n42:0,n43:0,n44:1,reset:function(){return this.n11=1,this.n12=0,this.n13=0,this.n14=0,this.n21=0,this.n22=1,this.n23=0,this.n24=0,this.n31=0,this.n32=0,this.n33=1,this.n34=0,this.n41=0,this.n42=0,this.n43=0,this.n44=1,this},translationMatrix:function(t,e,i){return this.n14=t,this.n24=e,this.n34=i,this},translationMatrixFromVector:function(t){var e=t.xyz;return this.n14=e[0],this.n24=e[1],this.n34=e[2],this},scaleMatrix:function(t,e,i){return this.n11=t,this.n22=e,this.n33=i,this},scaleMatrixFromVector:function(t){var e=t.xyz;return this.n11=e[0],this.n22=e[0],this.n33=e[0],this},rotationMatrix:function(t,e,i,n){var r=h(n),o=s(n),a=1-r,u=t*e*a,c=e*i*a,f=t*i*a,l=o*i,x=o*e,y=o*t;return this.n11=r+t*t*a,this.n12=-l+u,this.n13=x+f,this.n14=0,this.n21=l+u,this.n22=r+e*e*a,this.n23=-y+c,this.n24=0,this.n31=-x+f,this.n32=y+c,this.n33=r+i*i*a,this.n34=0,this},rotationMatrixFromVector:function(t,e){var i=t.xyz,n=i[0],r=i[1],o=i[2],a=h(e),u=s(e),c=1-a,f=n*r*c,l=r*o*c,x=n*o*c,y=u*o,m=u*r,v=u*n;return this.n11=a+n*n*c,this.n12=-y+f,this.n13=m+x,this.n14=0,this.n21=y+f,this.n22=a+r*r*c,this.n23=-v+l,this.n24=0,this.n31=-m+x,this.n32=v+l,this.n33=a+o*o*c,this.n34=0,this},multiply:function(t){return n(this,t),this},multiplyVector:function(t){var e=t.xyz,i=e[0],n=e[1],r=e[2];return e[0]=i*this.n11+n*this.n12+r*this.n13+this.n14,e[1]=i*this.n21+n*this.n22+r*this.n23+this.n24,e[2]=i*this.n31+n*this.n32+r*this.n33+this.n34,t}});r=o.multiplyVector=function(t,e){var i=e.xyz,n=i[0],r=i[1],s=i[2];return i[0]=n*t.n11+r*t.n12+s*t.n13+t.n14,i[1]=n*t.n21+r*t.n22+s*t.n23+t.n24,i[2]=n*t.n31+r*t.n32+s*t.n33+t.n34,e},n=o.calculateMultiply=function(t,e){var i=t.n11,n=e.n11,r=t.n21,s=e.n21,h=t.n31,o=e.n31,a=t.n12,u=e.n12,c=t.n22,f=e.n22,l=t.n32,x=e.n32,y=t.n13,m=e.n13,v=t.n23,d=e.n23,g=t.n33,p=e.n33,V=t.n14,M=e.n14,w=t.n24,z=e.n24,X=t.n34,P=e.n34;return t.n11=i*n+a*s+y*o,t.n12=i*u+a*f+y*x,t.n13=i*m+a*d+y*p,t.n14=i*M+a*z+y*P+V,t.n21=r*n+c*s+v*o,t.n22=r*u+c*f+v*x,t.n23=r*m+c*d+v*p,t.n24=r*M+c*z+v*P+w,t.n31=h*n+l*s+g*o,t.n32=h*u+l*f+g*x,t.n33=h*m+l*d+g*p,t.n34=h*M+l*z+g*P+X,t}}(i),function(t,i){var n=t.ModConstant,r=n.X,s=n.Y,h=n.Z,o=t.Vector3,a=t.VecArray;t.VertexProxy=e(Object,{constructor:function(t){this.xyz=new a([0,0,0]),this.original=new a([0,0,0]),this.ratio=new a([0,0,0]),i!==t&&null!==t&&!1!==t&&this.setVertex(t)},vertex:null,xyz:null,original:null,ratio:null,setVertex:function(t){return this.vertex=t,this},getRatioVector:function(){return new o(this.ratio)},getRatio:function(t){switch(t){case r:return this.ratio[0];case s:return this.ratio[1];case h:return this.ratio[2]}return-1},getOriginalValue:function(t){switch(t){case r:return this.original[0];case s:return this.original[1];case h:return this.original[2]}return 0},setRatios:function(t,e,n){return t=t===i?0:t,e=e===i?0:e,n=n===i?0:n,this.ratio=new a([t,e,n]),this},setOriginalPosition:function(t,e,n){return t=t===i?0:t,e=e===i?0:e,n=n===i?0:n,this.original=new a([t,e,n]),this},getXYZ:function(){return new a(this.xyz)},getXYZRef:function(){return this.xyz},getX:function(){return this.xyz[0]},getY:function(){return this.xyz[1]},getZ:function(){return this.xyz[2]},setXYZ:function(t){return t=new a(t),this},setXYZRef:function(t){return t=t,this},setX:function(t){return this.xyz[0]=t,this},setY:function(t){return this.xyz[1]=t,this},setZ:function(t){return this.xyz[2]=t,this},getValue:function(t){switch(t){case r:return this.getX();case s:return this.getY();case h:return this.getZ()}return 0},setValue:function(t,e){switch(t){case r:this.setX(e);break;case s:this.setY(e);break;case h:this.setZ(e)}return this},reset:function(){return this.setXYZ(this.original),this},collapse:function(){return this.original=this.getXYZ(),this},getVector:function(){return new o(this.getXYZ())},setVector:function(t){this.setXYZ(t.xyz)}})}(i),function(t){t.FaceProxy=e(Object,{constructor:function(){this.vertices=[]},vertices:null,addVertex:function(t){this.vertices.push(t)},getVertices:function(){return this.vertices}})}(i),function(t){var i=t.ModConstant,n=i.X,r=i.Y,s=i.Z,h=Math.min,o=Math.max;t.MeshProxy=e(Object,{constructor:function(t){this.maxX=null,this.maxY=null,this.maxZ=null,this.minX=null,this.minY=null,this.minZ=null,this.maxAxis=null,this.midAxis=null,this.minAxis=null,this.width=null,this.height=null,this.depth=null,this.vertices=[],this.faces=[],this.mesh=null,t&&this.setMesh(t)},maxX:null,maxY:null,maxZ:null,minX:null,minY:null,minZ:null,maxAxis:null,midAxis:null,minAxis:null,widht:null,height:null,depth:null,vertices:null,faces:null,mesh:null,setMesh:function(t){return this.mesh=t,this.vertices=[],this},getVertices:function(){return this.vertices},getFaces:function(){return this.faces},analyzeGeometry:function(){var t,e,i,a,u,c,f,l,x,y,m,v,d,g=this.vertices,p=g.length,V=p;for(p&&(t=g[0],e=t.getXYZ(),i=e[0],a=e[1],u=e[2],c=f=i,l=x=a,y=m=u);--V>=0;)t=g[V],e=t.getXYZ(),i=e[0],a=e[1],u=e[2],t.setOriginalPosition(i,a,u),c=h(c,i),l=h(l,a),y=h(y,u),f=o(f,i),x=o(x,a),m=o(m,u);v=f-c,d=x-l,depth=m-y,this.width=v,this.height=d,this.depth=depth,this.minX=c,this.maxX=f,this.minY=l,this.maxY=x,this.minZ=y,this.maxZ=m;var M=o(v,d,depth),w=h(v,d,depth);for(M==v&&w==d?(this.minAxis=r,this.midAxis=s,this.maxAxis=n):M==v&&w==depth?(this.minAxis=s,this.midAxis=r,this.maxAxis=n):M==d&&w==v?(this.minAxis=n,this.midAxis=s,this.maxAxis=r):M==d&&w==depth?(this.minAxis=s,this.midAxis=n,this.maxAxis=r):M==depth&&w==v?(this.minAxis=n,this.midAxis=r,this.maxAxis=s):M==depth&&w==d&&(this.minAxis=r,this.midAxis=n,this.maxAxis=s),V=p;--V>=0;)t=g[V],e=t.getXYZ(),t.setRatios((e[0]-c)/v,(e[1]-l)/d,(e[2]-y)/depth);return this},resetGeometry:function(){for(var t=this.vertices,e=t.length;--e>=0;)t[e].reset();return this.update(),this},collapseGeometry:function(){for(var t=this.vertices,e=t.length;--e>=0;)t[e].collapse();return this.update(),this.analyzeGeometry(),this},getMin:function(t){switch(t){case n:return this.minX;case r:return this.minY;case s:return this.minZ}return-1},getMax:function(t){switch(t){case n:return this.maxX;case r:return this.maxY;case s:return this.maxZ}return-1},getSize:function(t){switch(t){case n:return this.width;case r:return this.height;case s:return this.depth}return-1},update:function(){return this},postApply:function(){return this},updateMeshPosition:function(){return this}})}(i),function(t){t.Modifier=e(Object,{constructor:function(t){this.mod=t||null},mod:null,setModifiable:function(t){return this.mod=t,this},getVertices:function(){return this.mod.getVertices()},apply:function(){return this}})}(i),function(t){t.Library3d=e(Object,{constructor:function(){this.id="",this.meshClass=null,this.vertexClass=null},id:"",meshClass:null,vertexClass:null})}(i),function(t){t.PluginFactory={getMeshProxy:function(t){var e=t.meshClass;return e?new e:null}}}(i),function(t){var i=t.PluginFactory.getMeshProxy;t.ModifierStack=e(Object,{constructor:function(t,e){this.baseMesh=null,this.stack=[],this.lib3d=t,this.baseMesh=i(t),this.baseMesh.setMesh(e),this.baseMesh.analyzeGeometry()},lib3d:null,baseMesh:null,stack:null,addModifier:function(t){return t.setModifiable(this.baseMesh),this.stack.push(t),this},apply:function(){var t=this.stack,e=t.length,i=this.baseMesh,n=0;for(i.resetGeometry();e>n;)t[n++].apply();return i.update(),this},collapse:function(){return this.apply(),this.baseMesh.collapseGeometry(),this.stack.length=0,this},clear:function(){return this.stack.length=0,this},getMeshInfo:function(){return this.baseMesh}})}(i),function(t){var i=t.Vector3;t.Pivot=e(t.Modifier,{constructor:function(t,e,n){this.pivot=new i([t,e,n])},pivot:null,setMeshCenter:function(){var t=this.mod;return this.pivot=new i(-(t.minX+.5*t.width),-(t.minY+.5*t.height),-(t.minZ+.5*t.depth)),this},apply:function(){for(var t,e=this.mod.getVertices(),i=e.length,n=this.pivot;--i>=0;)t=e[i],t.setVector(t.getVector().addSelf(n));return this.mod.updateMeshPosition(n.negate()),this}})}(i),function(t,i){var n=t.ModConstant.NONE,r=t.ModConstant.LEFT,s=t.ModConstant.RIGHT,h=t.Matrix,o=Math.atan,a=(Math.atan2,Math.sin),u=Math.cos,c=t.Constants.PI,f=t.Constants.halfPI,l=t.Constants.doublePI,x=t.Point;t.Bend=e(t.Modifier,{constructor:function(t,e,r){this.constraint=n,this.max=0,this.min=0,this.mid=0,this.width=0,this.height=0,this.origin=0,this.m1=null,this.m2=null,this.diagAngle=0,this.switchAxes=!1,this.force=t!==i?t:0,this.offset=e!==i?e:0,r!==i?this.setAngle(r):this.setAngle(0)},force:0,offset:0,angle:0,diagAngle:0,constraint:n,max:0,min:0,mid:0,width:0,height:0,origin:0,m1:null,m2:null,switchAxes:!1,setAngle:function(t){return this.angle=t,this.m1=(new h).rotate(t),this.m2=(new h).rotate(-t),this},setModifiable:function(t){return this.$super("setModifiable",t),this.max=this.switchAxes?this.mod.midAxis:this.mod.maxAxis,this.min=this.mod.minAxis,this.mid=this.switchAxes?this.mod.maxAxis:this.mod.midAxis,this.width=this.mod.getSize(this.max),this.height=this.mod.getSize(this.mid),this.origin=this.mod.getMin(this.max),this.diagAngle=o(this.width/this.height),this},apply:function(){if(!this.force)return this;for(var t,e,i,n,h,o,y,m,v,d,g=this.mod.getVertices(),p=g.length,V=this.constraint,M=this.width,w=this.offset,z=this.origin,X=this.force,P=this.max,A=this.min,Z=this.mid,Y=this.m1,b=this.m2,I=z+M*w,O=M/c/X,R=l*(M/(O*l)),T=1/M;--p>=0;)t=g[p],e=t.getValue(P),i=t.getValue(Z),n=t.getValue(A),h=Y.transformPointSelf(new x(e,i)),e=h.x,i=h.y,o=(e-z)*T,V==r&&w>=o||V==s&&o>=w||(y=f-R*w+R*o,m=a(y)*(O+n),v=u(y)*(O+n),n=m-O,e=I-v),d=b.transformPointSelf(new x(e,i)),e=d.x,i=d.y,t.setValue(P,e),t.setValue(Z,i),t.setValue(A,n);return this}})}(i),function(t){var i=t.Vector3,n=Math.max,r=Math.exp;t.Bloat=e(t.Modifier,{constructor:function(){this.radius=0,this.a=.01,this.center=i.ZERO()},center:null,radius:0,a:.01,setRadius:function(t){return this.radius=n(0,t),this},setA:function(t){return this.a=n(0,t),this},apply:function(){for(var t,e,i,n=this.mod.getVertices(),s=n.length,h=this.center,o=this.radius,a=this.a;--s>=0;)t=n[s],i=t.getVector().subtractSelf(h),e=i.getMagnitude(),i.setMagnitude(e+o*r(-e*a)),t.setVector(i.addSelf(h));return this}})}(i),function(t,i){var n=t.Vector3,r=t.Matrix4;t.Twist=e(t.Modifier,{constructor:function(t){this.vector=new n([0,1,0]),this.angle=t!==i?t:0,this.center=n.ZERO(),this.mat1=new r,this.mat2=new r},vector:null,angle:0,center:null,mat1:null,mat2:null,apply:function(){for(var t,e,i,r=this.mod,s=r.getVertices(),h=s.length,o=this.vector.normalizeSelf(),a=this.angle,u=this.center,c=new n([.5*r.maxX,.5*r.maxY,.5*r.maxZ]),f=1/c.getMagnitude(),l=f*a,x=-n.dot(o,u);--h>=0;)t=s[h],i=t.getVector(),e=n.dot(i,o)+x,t.setVector(this.twistPoint(i,o,e*l));return this},twistPoint:function(t,e,i){var r=this.mat1.reset().translationMatrixFromVector(t),s=this.mat2.reset().rotationMatrixFromVector(e,i);return s.multiply(r),new n([s.n14,s.n24,s.n34])}})}(i),function(t,i){var n=Math.abs,r=Math.pow,s=(t.XMath.sign,t.ModConstant),h=s.NONE,o=s.LEFT,a=s.RIGHT,u=s.X,c=s.Y,f=s.Z;t.Skew=e(t.Modifier,{constructor:function(t){this.force=t!==i?t:0,this.offset=.5,this.constraint=h,this.power=1,this.falloff=1,this.inverseFalloff=!1,this.oneSide=!1,this.swapAxes=!1,this.skewAxis=0},force:0,skewAxis:0,offset:.5,constraint:h,power:1,falloff:1,inverseFalloff:!1,oneSide:!1,swapAxes:!1,setModifiable:function(t){return this.$super("setModifiable",t),this.skewAxis=this.skewAxis||this.mod.maxAxis,this},apply:function(){for(var t,e,i,s,h,u,c,f,l=this.mod.getVertices(),x=l.length,y=this.constraint,m=this.skewAxis,v=this.offset,d=this.oneSide,g=this.inverseFalloff,p=this.falloff,V=1-p,M=this.power,w=this.force,z=this.getDisplaceAxis();--x>=0;)t=l[x],c=t.getRatio(m),y==o&&v>=c||y==a&&c>v||(e=c-v,d&&(e=n(e)),i=t.getRatio(z),g&&(i=1-i),s=p+i*V,f=0>e?-1:1,h=r(n(e),M)*f,u=t.getValue(z)+w*h*s,t.setValue(z,u));return this},getDisplaceAxis:function(){var t=this.skewAxis,e=this.swapAxes;switch(t){case u:return e?f:c;case c:return e?f:u;case f:return e?c:u}}})}(i),function(t,i){var n=t.Vector3,r=t.Matrix4,s=Math.pow;t.Taper=e(t.Modifier,{constructor:function(t){this.vector=new n([1,0,1]),this.vector2=new n([0,1,0]),this.force=t!==i?t:0,this.power=1},force:0,power:1,vector:null,vector2:null,apply:function(){var t,e,i,n,h,o,a=this.mod.getVertices(),u=a.length,c=this.vector,f=this.vector2,l=this.force,x=this.power;for(n=new r;--u>=0;)t=a[u],e=t.getRatioVector().multiply(f),i=1!=x?l*s(e.getMagnitude(),x):l*e.getMagnitude(),o=c.xyz,n.reset().scaleMatrix(1+i*o[0],1+i*o[1],1+i*o[2]),h=t.getVector(),t.setVector(n.multiplyVector(h));return this}})}(i),function(t){var i=t.Constants.invPI,n=t.Constants.doublePI,r=t.Vector3,s=t.Matrix4;t.Wheel=e(t.Modifier,{constructor:function(){this.speed=0,this.turn=0,this.roll=0,this.radius=0,this.steerVector=new r([0,1,0]),this.rollVector=new r([0,0,1])},speed:0,turn:0,roll:0,radius:0,steerVector:null,rollVector:null,setModifiable:function(t){return this.$super("setModifiable",t),this.radius=.5*this.mod.width,this},apply:function(){var t,e,i=this.mod.getVertices(),n=i.length,r=this.steerVector,h=this.turn,o=this.rollVector,a=this.roll,u=null,c=null,f=null;for(this.roll+=this.speed,h?(c=(new s).rotationMatrixFromVector(r,h),f=c.multiplyVector(o.clone()),u=(new s).rotationMatrixFromVector(f,a)):u=(new s).rotationMatrixFrom(o,a);--n>=0;)t=i[n],e=t.getVector(),c&&c.multiplyVector(e),setVector(u.multiplyVector(e));return this},getStep:function(){return this.radius*this.speed*i},getPerimeter:function(){return this.radius*n}})}(i),function(t,i){var n=t.Vector3,r=t.Range,s=t.Matrix4;t.Break=e(t.Modifier,{constructor:function(t,e){this.bv=new n([0,1,0]),this.range=new r(0,1),this.offset=t!==i?t:0,this.angle=e!==i?e:0},bv:null,range:null,offset:0,angle:0,apply:function(){var t,e,i,r,h,o=this.mod,a=o.getVertices(),u=a.length,c=this.offset,f=this.range,l=this.angle,x=this.bv,y=x.xyz;for(t=new n([0,0,-(o.minZ+o.depth*c)]),e=t.negate(),h=(new s).rotationMatrix(y[0],y[1],y[2],l);--u>=0;)i=a[u],r=i.getVector().addSelf(t),r.xyz[2]>=0&&f.isIn(i.ratio[1])&&h.multiplyVector(r),i.setVector(r.addSelf(e));return this}})}(i),function(t,i){var n=t.ModConstant.NONE,r=t.ModConstant.X,s=t.ModConstant.Y,h=t.ModConstant.Z,o=(t.VecArray,Math.random);t.Noise=e(t.Modifier,{constructor:function(t){this.axc=n,this.start=0,this.end=0,this.force=t!==i?t:0},force:0,axc:n,start:0,end:1,constraintAxes:function(t){return this.axc=t,this},setFalloff:function(t,e){return this.start=t!==i?t:0,this.end=e!==i?e:1,this},apply:function(){for(var t,e,i,n,a,u=this.mod,c=this.axc,f=this.start,l=this.end,x=u.getVertices(),y=x.length,m=this.force,v=.5*m;--y>=0;)t=x[y],e=o()*m-v,i=t.getRatio(u.maxAxis),l>f?f>i?i=0:i>l&&(i=1):f>l?(i=1-i,i>f?i=0:l>i&&(i=1)):i=1,n=e*i,a=t.getXYZ(),t.setXYZ([a[0]+(c&r?0:n),a[1]+(c&s?0:n),a[2]+(c&h?0:n)]);return this}})}(i),function(t){var i=t.ModConstant,n=i.X,r=i.Y,s=i.Z,h=t.Vector3,o=t.VecArray,a=t.VertexThree=e(t.VertexProxy,{constructor:function(t,e){this.mesh=t,this.$super("constructor",e)},mesh:null,setVertex:function(t){return this.vertex=t,this.original=new o([t.x,t.y,t.z]),this.xyz=new o(this.original),this},getXYZ:function(){var t=this.vertex;return new o([t.x,t.y,t.z])},getX:function(){return this.vertex.x},getY:function(){return this.vertex.y},getZ:function(){return this.vertex.z},setXYZ:function(t){var e=this.vertex;return this.mesh.geometry,e.x=t[0],e.y=t[1],e.z=t[2],this},setX:function(t){var e=this.vertex;return e.x=t,this},setY:function(t){var e=this.vertex;return e.y=t,this},setZ:function(t){var e=this.vertex;return e.z=t,this},reset:function(){var t=this.vertex,e=(this.mesh.geometry,this.original);return t.x=e[0],t.y=e[1],t.z=e[2],this},collapse:function(){var t=this.vertex;return this.original=new o([t.x,t.y,t.z]),this},getValue:function(t){var e=this.vertex;switch(t){case n:return e.x;case r:return e.y;case s:return e.z}return 0},setValue:function(t,e){var i=this.vertex,h=!1;switch(t){case n:i.x=e,h=!0;break;case r:i.y=e,h=!0;break;case s:i.z=e,h=!0}return this},setVector:function(t){var e=this.vertex,i=t.xyz;return this.mesh.geometry,e.x=i[0],e.y=i[1],e.z=i[2],this},getVector:function(){var t=this.vertex;return new h([t.x,t.y,t.z])}});a.prototype.getXYZRef=a.prototype.getXYZ,a.prototype.setXYZRef=a.prototype.setXYZ}(i),function(t){var i=t.VertexThree;t.FaceProxy,t.MeshThree=e(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var e,n=0,t=this.mesh,r=this.vertices,s=t.geometry.vertices,h=s.length,o=t.geometry.faces;for(o.length,n=0;h>n;)e=new i(t,s[n]),r.push(e),n++;return this.faces=null,this},update:function(){var t=this.mesh.geometry;return t.verticesNeedUpdate=!0,t.normalsNeedUpdate=!0,t.buffersNeedUpdate=!0,t.dynamic=!0,this},updateMeshPosition:function(t){var e=this.mesh.position,i=t.xyz;return e.x+=i[0],e.y+=i[1],e.z+=i[2],this}})}(i),function(t){var i=e(t.Library3d,{constructor:function(){this.id="Three.js",this.meshClass=t.MeshThree,this.vertexClass=t.VertexThree}});t.LibraryThree=new i}(i),function(t){var i=t.ModConstant,n=i.X,r=i.Y,s=i.Z,h=t.Vector3,o=t.VecArray,a=t.VertexJ3D=e(t.VertexProxy,{constructor:function(t,e){this.geometry=t,this.VERTEX_POSITION=J3D.Mesh.VERTEX_POSITION,this.$super("constructor",e)},geometry:null,VERTEX_POSITION:null,setVertex:function(t){var e=this.geometry,i=e.arraysByName[this.VERTEX_POSITION],n=i.data;return this.vertex=t,this.original=new o([n[t],n[t+1],n[t+2]]),this.xyz=new o(this.original),this},getXYZ:function(){var t=this.vertex,e=this.geometry,i=e.arraysByName[this.VERTEX_POSITION],n=i.data;return new o([n[t],n[t+1],n[t+2]])},getX:function(){var t=this.vertex,e=this.geometry,i=e.arraysByName[this.VERTEX_POSITION],n=i.data;return n[t]},getY:function(){var t=this.vertex,e=this.geometry,i=e.arraysByName[this.VERTEX_POSITION],n=i.data;return n[t+1]},getZ:function(){var t=this.vertex,e=this.geometry,i=e.arraysByName[this.VERTEX_POSITION],n=i.data;return n[t+2]},setXYZ:function(t){var e=this.vertex,i=this.geometry,n=i.arraysByName[this.VERTEX_POSITION],r=n.data;return r[e]=t[0],r[e+1]=t[1],r[e+2]=t[2],this},setX:function(t){var e=this.vertex,i=this.geometry,n=i.arraysByName[this.VERTEX_POSITION],r=n.data;return r[e]=t,this},setY:function(t){var e=this.vertex,i=this.geometry,n=i.arraysByName[this.VERTEX_POSITION],r=n.data;return r[e+1]=t,this},setZ:function(t){var e=this.vertex,i=this.geometry,n=i.arraysByName[this.VERTEX_POSITION],r=n.data;return r[e+2]=t,this},reset:function(){var t=this.vertex,e=this.geometry,i=e.arraysByName[this.VERTEX_POSITION],n=i.data,r=this.original;return n[t]=r[0],n[t+1]=r[1],n[t+2]=r[2],this},collapse:function(){var t=this.vertex,e=this.geometry,i=e.arraysByName[this.VERTEX_POSITION],n=i.data;return this.original=new o([n[t],n[t+1],n[t+2]]),this},getValue:function(t){var e=this.vertex,i=this.geometry,h=i.arraysByName[this.VERTEX_POSITION],o=h.data;switch(t){case n:return o[e];case r:return o[e+1];case s:return o[e+2]}return 0},setValue:function(t,e){var i=this.vertex,h=this.geometry,o=h.arraysByName[this.VERTEX_POSITION],a=o.data,u=!1;switch(t){case n:a[i]=e,u=!0;break;case r:a[i+1]=e,u=!0;break;case s:a[i+2]=e,u=!0}return this},setVector:function(t){var e=this.vertex,i=this.geometry,n=i.arraysByName[this.VERTEX_POSITION],r=n.data,s=t.xyz;return r[e]=s[0],r[e+1]=s[1],r[e+2]=s[2],this},getVector:function(){var t=this.vertex,e=this.geometry,i=e.arraysByName[this.VERTEX_POSITION],n=i.data;return new h([n[t],n[t+1],n[t+2]])}});a.prototype.getXYZRef=a.prototype.getXYZ,a.prototype.setXYZRef=a.prototype.setXYZ}(i),function(t){var i=t.VertexJ3D;t.FaceProxy,t.VecArray,t.MeshJ3D=e(t.MeshProxy,{constructor:function(t){this.VERTEX_POSITION=J3D.Mesh.VERTEX_POSITION,this.$super("constructor",t)},VERTEX_POSITION:null,setMesh:function(t){this.$super("setMesh",t);var e,n=0,r=t.geometry,s=r.arraysByName[this.VERTEX_POSITION],h=s.data,o=h.length,a=s.itemSize,u=this.vertices;for(n=0;o>n;)e=new i(r,n),u.push(e),n+=a;return this.faces=null,this},update:function(){var t=this.mesh.geometry,e=t.arraysByName[this.VERTEX_POSITION],i=e.data;return t.replaceArray(e,i),this},updateMeshPosition:function(t){var e=this.mesh.position,i=t.xyz;return e.x+=i[0],e.y+=i[1],e.z+=i[2],this}})}(i),function(t){var i=e(t.Library3d,{constructor:function(){this.id="J3D",this.meshClass=t.MeshJ3D,this.vertexClass=t.VertexJ3D}});t.LibraryJ3D=new i}(i),function(t){var i=t.ModConstant,n=i.X,r=i.Y,s=i.Z,h=t.Vector3,o=t.VecArray,a=t.VertexCopperlicht=e(t.VertexProxy,{constructor:function(t,e,i){this.node=t,this.buffer=e,this.$super("constructor",i)},node:null,buffer:null,setVertex:function(t){var e=t.Pos;return this.vertex=t,this.original=new o([e.X,e.Y,e.Z]),this.xyz=new o(this.original),this},getXYZ:function(){var t=this.vertex.Pos;return new o([t.X,t.Y,t.Z])},getX:function(){return this.vertex.Pos.X},getY:function(){return this.vertex.Pos.Y},getZ:function(){return this.vertex.Pos.Z},setXYZ:function(t){var e=this.vertex.Pos;return e.X=t[0],e.Y=t[1],e.Z=t[2],this},setX:function(t){var e=this.vertex.Pos;return e.X=t,this},setY:function(t){var e=this.vertex.Pos;return e.Y=t,this},setZ:function(t){var e=this.vertex.Pos;return e.Z=t,this},reset:function(){var t=this.vertex.Pos,e=this.original;return t.X=e[0],t.Y=e[1],t.Z=e[2],this},collapse:function(){var t=this.vertex.Pos;return this.original=new o([t.X,t.Y,t.Z]),this},getValue:function(t){var e=this.vertex.Pos;switch(t){case n:return e.X;case r:return e.Y;case s:return e.Z}return 0},setValue:function(t,e){var i=this.vertex.Pos,h=!1;switch(t){case n:i.X=e,h=!0;break;case r:i.Y=e,h=!0;break;case s:i.Z=e,h=!0}return this},setVector:function(t){var e=this.vertex.Pos,i=t.xyz;return e.X=i[0],e.Y=i[1],e.Z=i[2],this},getVector:function(){var t=this.vertex.Pos;return new h([t.X,t.Y,t.Z])}});a.prototype.getXYZRef=a.prototype.getXYZ,a.prototype.setXYZRef=a.prototype.setXYZ}(i),function(t){var i=t.VertexCopperlicht;t.FaceProxy,t.MeshCopperlicht=e(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var e,n,r,s,h,o=this.mesh.getMesh().GetMeshBuffers(),a=this.vertices,u=[];for(n=0,r=o.length;r>n;n++)for(u=o[n].Vertices,e=0,s=u.length;s>e;e++)h=new i(this.mesh,o[n],u[e]),a.push(h);return this.faces=null,this},update:function(){for(var t=this.mesh.getMesh().GetMeshBuffers(),e=t.length,i=0;e>i;)t[i].update(!0),i++;return this},updateMeshPosition:function(t){var e=this.mesh.Pos,i=t.xyz;return e.X+=i[0],e.Y+=i[1],e.Z+=i[2],this}})}(i),function(t){var i=e(t.Library3d,{constructor:function(){this.id="Copperlicht",this.meshClass=t.MeshCopperlicht,this.vertexClass=t.VertexCopperlicht}});t.LibraryCopperlicht=new i}(i),function(t){var i=t.ModConstant,n=i.X,r=i.Y,s=i.Z,h=t.Vector3,o=t.VecArray,a=t.VertexCubicVR=e(t.VertexProxy,{constructor:function(t,e){this.sceneObject=t,this.$super("constructor",e)},sceneObject:null,setVertex:function(t){return this.vertex=t,this.original=new o(t),this.xyz=new o(t),this},getXYZ:function(){return new o(this.vertex)},getX:function(){return this.vertex[0]},getY:function(){return this.vertex[1]},getZ:function(){return this.vertex[2]},setXYZ:function(t){var e=this.vertex;return e[0]=t[0],e[1]=t[1],e[2]=t[2],this},setX:function(t){var e=this.vertex;return e[0]=t,this},setY:function(t){var e=this.vertex;return e[1]=t,this},setZ:function(t){var e=this.vertex;return e[2]=t,this},reset:function(){var t=this.vertex,e=this.original;return t[0]=e[0],t[1]=e[1],t[2]=e[2],this},collapse:function(){return this.original=new o(this.vertex),this},getValue:function(t){var e=this.vertex;switch(t){case n:return e[0];case r:return e[1];case s:return e[2]}return 0},setValue:function(t,e){var i=this.vertex,h=!1;switch(t){case n:i[0]=e,h=!0;break;case r:i[1]=e,h=!0;break;case s:i[2]=e,h=!0}return this},setVector:function(t){var e=this.vertex,i=t.xyz;return e[0]=i[0],e[1]=i[1],e[2]=i[2],this},getVector:function(){return new h(this.vertex)}});a.prototype.getXYZRef=a.prototype.getXYZ,a.prototype.setXYZRef=a.prototype.setXYZ}(i),function(t){var i=t.VertexCubicVR;t.FaceProxy,t.MeshCubicVR=e(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var e,n=0,r=t.obj.points,s=r.length,h=t.obj.faces,o=(h.length,this.vertices);for(n=0;s>n;)e=new i(t,r[n]),o.push(e),n++;return this.faces=null,this},update:function(){return this.mesh.dirty=!0,this},updateMeshPosition:function(t){var e=this.mesh.position,i=t.xyz;return e[0]+=i[0],e[1]+=i[1],e[2]+=i[2],this}})}(i),function(t){var i=e(t.Library3d,{constructor:function(){this.id="CubicVR.js",this.meshClass=t.MeshCubicVR,this.vertexClass=t.VertexCubicVR
}});t.LibraryCubicVR=new i}(i),function(t){var i=t.ModConstant,n=i.X,r=i.Y,s=i.Z,h=t.Vector3,o=t.VecArray,a=t.VertexPre3D=e(t.VertexProxy,{constructor:function(t){this.$super("constructor",t)},setVertex:function(t){return this.vertex=t,this.original=new o([t.x,t.y,t.z]),this.xyz=new o(this.original),this},getXYZ:function(){var t=this.vertex;return new o([t.x,t.y,t.z])},getX:function(){return this.vertex.x},getY:function(){return this.vertex.y},getZ:function(){return this.vertex.z},setXYZ:function(t){var e=this.vertex;return e.x=t[0],e.y=t[1],e.z=t[2],this},setX:function(t){return this.vertex.x=t,this},setY:function(t){return this.vertex.y=t,this},setZ:function(t){return this.vertex.z=t,this},getValue:function(t){var e=this.vertex;switch(t){case n:return e.x;case r:return e.y;case s:return e.z}return 0},setValue:function(t,e){var i=this.vertex;switch(t){case n:i.x=e;break;case r:i.y=e;break;case s:i.z=e}return this},setVector:function(t){var e=this.vertex,i=t.xyz;return e.x=i[0],e.y=i[1],e.z=i[2],this},getVector:function(){var t=this.vertex;return new h([t.x,t.y,t.z])}});a.prototype.getXYZRef=a.prototype.getXYZ,a.prototype.setXYZRef=a.prototype.setXYZ}(i),function(t){var i=t.VertexPre3D;t.FaceProxy,t.MeshPre3D=e(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var e,n,r=this.mesh.vertices,s=this.mesh.quads,h=r.length,o=(s.length,this.vertices);for(e=0;h>e;e++)n=new i(r[e]),o.push(n);return this.faces=null,this}})}(i),function(t){var i=e(t.Library3d,{constructor:function(){this.id="pre3d.js",this.meshClass=t.MeshPre3D,this.vertexClass=t.VertexPre3D}});t.LibraryPre3D=new i}(i),i});