/**
*
*   MOD3.js
*   @version: 0.3.3
*
*   MOD3 3D Modifier Library for JavaScript 
*   port of AS3DMod ActionScript3 library (http://code.google.com/p/as3dmod/)
*   https://github.com/foo123/MOD3
*
**/!function(t,i,n,s,e){n=n?[].concat(n):[];var r,h,o=Array,u=o.prototype,a=n.length,l=new o(a);if("object"==typeof module&&module.exports){if(e===module.exports[i]){for(r=0;a>r;r++)l[r]=module.exports[n[r][0]]||require(n[r][1])[n[r][0]];h=s.apply(t,l),module.exports[i]=h||1}}else if("function"==typeof define&&define.amd)define(["exports"].concat(n.map(function(t){return t[1]})),function(r){if(e===r[i]){var o,a=u.slice.call(arguments,1),c=a.length;for(o=0;c>o;o++)l[o]=r[n[o][0]]||a[o];h=s.apply(t,l),r[i]=h||1}});else if(e===t[i]){for(r=0;a>r;r++)l[r]=t[n[r][0]];h=s.apply(t,l),t[i]=h||1}}(this,"MOD3",[["Classy","./classy"]],function(t){var i=t.Class,n=n||{VERSION:"0.3.3"};return function(t){t.Constants={PI:Math.PI,invPI:1/Math.PI,halfPI:.5*Math.PI,doublePI:2*Math.PI,toRad:Math.PI/180,toDeg:180/Math.PI},t.ModConstant={LEFT:-1,RIGHT:1,NONE:0,X:1,Y:2,Z:4},t.Array32F="undefined"!=typeof Float32Array?Float32Array:Array,t.Array64F="undefined"!=typeof Float64Array?Float64Array:Array,t.Array8I="undefined"!=typeof Int8Array?Int8Array:Array,t.Array16I="undefined"!=typeof Int16Array?Int16Array:Array,t.Array32I="undefined"!=typeof Int32Array?Int32Array:Array,t.Array8U="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Array16U="undefined"!=typeof Uint16Array?Uint16Array:Array,t.Array32U="undefined"!=typeof Uint32Array?Uint32Array:Array,t.VecArray=t.Array32F}(n),function(t,i){var n,s=t.Constants.toRad,e=t.Constants.toDeg,r=Math.min,h=Math.max,o=Math.pow,u=Math.round,a=Math.florr,l=Math.ceil,c=t.XMath={normalize:function(t,i,s){var e,r=i-t;return e=0==r?1:n(0,1,(s-t)/i)},toRange:function(t,i,n){var s,e=i-t;return s=0==e?0:t+(i-t)*n},inRange:function(t,n,s,e){return e===i&&(e=!1),e?s>=t&&n>=s:s>t&&n>s},sign:function(t,n){return n===i&&(n=0),0==t?n:t>0?1:-1},trim:function(t,i,n){return r(i,h(t,n))},wrap:function(t,i,n){var s=i-t;return t>n?n+s:n>=i?n-s:n},degToRad:function(t){return t*s},radToDeg:function(t){return t*e},presicion:function(t,i){var n=o(10,i);return u(t*n)/n},uceil:function(t){return 0>t?a(t):l(t)}};n=c.clamp=c.trim}(n),function(t,n){var s=t.XMath.normalize,e=t.XMath.toRange,r=t.XMath.trim;t.Range=i(Object,{constructor:function(t,i){this.start=0,this.end=1,t!==n&&(this.start=t),i!==n&&(this.end=i)},start:0,end:1,dispose:function(){return this.start=null,this.end=null,this},getSize:function(){return this.end-this.start},move:function(t){this.start+=t,this.end+=t},isIn:function(t){return t>=this.start&&t<=this.end},normalize:function(t){return s(this.start,this.end,t)},toRange:function(t){return e(this.start,this.end,t)},trim:function(t){return r(this.start,this.end,t)},interpolate:function(t,i){return e(this.start,this.end,i.normalize(t))},toString:function(){return"["+this.start+" - "+this.end+"]"}})}(n),function(t,n){var s=Math.sin,e=Math.abs;t.Phase=i(Object,{constructor:function(t){this.value=0,t!==n&&(this.value=t)},value:0,dispose:function(){return this.value=null,this},getPhasedValue:function(){return s(this.value)},getAbsPhasedValue:function(){return e(s(this.value))},getNormValue:function(){return.5*(s(this.value)+1)}})}(n),function(t,n){var s=t.Point=i(Object,{constructor:function(t,i){this.x=t===n?0:t,this.y=i===n?0:i},x:0,y:0,dispose:function(){return this.x=null,this.y=null,this},clone:function(){return new s(this.x,this.y)}})}(n),function(t,n){var s=Math.sin,e=Math.cos,r=t.Point,h=t.Matrix=i(Object,{constructor:function(t,i,s,e){this.m11=t===n?1:t,this.m12=i===n?0:i,this.m21=s===n?0:s,this.m22=e===n?1:e},m11:1,m12:0,m21:0,m22:1,dispose:function(){return this.m11=null,this.m12=null,this.m21=null,this.m22=null,this},reset:function(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this},rotate:function(t){var i=e(t),n=s(t);return this.m11=i,this.m12=-n,this.m21=n,this.m22=i,this},scale:function(t,i){return this.m12=0,this.m21=0,t!==n&&(this.m11=t,this.m22=t),i!==n&&(this.m22=i),this},multiply:function(t){var i=this.m11,n=this.m12,s=this.m21,e=this.m22,r=t.m11,h=t.m12,o=t.m21,u=t.m22;return this.m11=i*r+n*o,this.m12=i*h+n*u,this.m21=s*r+e*o,this.m22=s*h+e*u,this},transformPoint:function(t){var i=t.x,n=t.y,s=this.m11*i+this.m12*n,e=this.m21*i+this.m22*n;return new r(s,e)},transformPointSelf:function(t){var i=t.x,n=t.y;return t.x=this.m11*i+this.m12*n,t.y=this.m21*i+this.m22*n,t},clone:function(){return new h(this.m11,this.m12,this.m21,this.m22)}})}(n),function(t,n){var s=Math.sqrt,e=t.VecArray,r=t.Vector3=i(Object,{constructor:function(t,i,s){t&&t.length?this.xyz=new e([t[0],t[1],t[2]]):(t=t===n?0:t,i=i===n?0:i,s=s===n?0:s,this.xyz=new e([t,i,s]))},xyz:null,dispose:function(){return this.xyz=null,this},getXYZ:function(){return new e(this.xyz)},getXYZRef:function(){return this.xyz},setXYZ:function(t){return this.xyz=new e(t),this},setXYZRef:function(t){return this.xyz=t,this},clone:function(){return new r(this.xyz)},equalsSelf:function(t){var i=this.xyz,n=t.xyz;return i[0]==n[0]&&i[1]==n[1]&&i[2]==n[2]},zeroSelf:function(){return this.xyz[0]=0,this.xyz[1]=0,this.xyz[2]=0,this},negate:function(){var t=this.xyz;return new r([-t[0],-t[1],-t[2]])},negateSelf:function(){var t=this.xyz;return t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],this},add:function(t){var i=this.xyz,n=t.xyz;return new r([i[0]+n[0],i[1]+n[1],i[2]+n[2]])},addSelf:function(t){var i=this.xyz,n=t.xyz;return i[0]+=n[0],i[1]+=n[1],i[2]+=n[2],this},subtract:function(t){var i=this.xyz,n=t.xyz;return new r([i[0]-n[0],i[1]-n[1],i[2]-n[2]])},subtractSelf:function(t){var i=this.xyz,n=t.xyz;return i[0]-=n[0],i[1]-=n[1],i[2]-=n[2],this},multiplyScalar:function(t){var i=this.xyz;return new r([i[0]*t,i[1]*t,i[2]*t])},multiplyScalarSelf:function(t){var i=this.xyz;return i[0]*=t,i[1]*=t,i[2]*=t,this},multiply:function(t){var i=this.xyz,n=t.xyz;return new r([i[0]*n[0],i[1]*n[1],i[2]*n[2]])},multiplySelf:function(t){var i=this.xyz,n=t.xyz;return i[0]*=n[0],i[1]*=n[1],i[2]*=n[2],this},divide:function(t){var i=1/t,n=this.xyz;return new r([n[0]*i,n[1]*i,n[2]*i])},divideSelf:function(t){var i=1/t,n=this.xyz;return n[0]*=i,n[1]*=i,n[2]*=i,this},normalize:function(){var t,i=this.xyz,n=i[0],e=i[1],h=i[2],o=n*n+e*e+h*h;return o>0&&(t=1/s(o),n*=t,e*=t,h*=t),new r([n,e,h])},normalizeSelf:function(){var t,i=this.xyz,n=i[0],e=i[1],r=i[2],h=n*n+e*e+r*r;return h>0&&(t=1/s(h),n*=t,e*=t,r*=t),i[0]=n,i[1]=e,i[2]=r,this},getMagnitude:function(){var t=this.xyz,i=t[0],n=t[1],e=t[2];return s(i*i+n*n+e*e)},setMagnitude:function(t){this.normalizeSelf();var i=this.xyz;return i[0]*=t,i[1]*=t,i[2]*=t,this},dotSelf:function(t){var i=this.xyz,n=t.xyz;return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]},crossSelf:function(t){var i=this.xyz,n=t.xyz,s=i[0],e=i[1],r=i[2],h=n[0],o=n[1],u=n[2];return i[0]=e*u-r*o,i[1]=r*h-s*u,i[2]=s*o-e*h,this},distanceSelf:function(t){var i=this.xyz,n=t.xyz,e=i[0]-n[0],r=i[1]-n[1],h=i[2]-n[2];return s(e*e+r*r+h*h)},toString:function(){return"["+this.xyz[0]+" , "+this.xyz[1]+" , "+this.xyz[2]+"]"}});r.ZERO=function(){return new r([0,0,0])},r.dot=function(t,i){var n=t.xyz,s=i.xyz;return n[0]*s[0]+n[1]*s[1]+n[2]*s[2]},r.equals=function(t,i){var n=t.xyz,s=i.xyz;return n[0]==s[0]&&n[1]==s[1]&&n[2]==s[2]},r.cross=function(t,i){var n=t.xyz,s=i.xyz,e=n[0],h=n[1],o=n[2],u=s[0],a=s[1],l=s[2];return new r([h*l-o*a,o*u-e*l,e*a-h*u])},r.distance=function(t,i){var n=t.xyz,e=i.xyz,r=n[0]-e[0],h=n[1]-e[1],o=n[2]-e[2];return s(r*r+h*h+o*o)},r.sum=function(t,i){var n=t.xyz,s=i.xyz;return new r([n[0]+s[0],n[1]+s[1],n[2]+s[2]])}}(n),function(t,n){var s,e,r=Math.sin,h=Math.cos,o=t.Matrix4=i(Object,{constructor:function(t,i,s,e,r,h,o,u,a,l,c,f,d,m,x,p){this.n11=t===n?1:t,this.n12=i===n?0:i,this.n13=s===n?0:s,this.n14=e===n?0:e,this.n21=r===n?0:r,this.n22=h===n?1:h,this.n23=o===n?0:o,this.n24=u===n?0:u,this.n31=a===n?0:a,this.n32=l===n?0:l,this.n33=c===n?1:c,this.n34=f===n?0:f,this.n41=d===n?0:d,this.n42=m===n?0:m,this.n43=x===n?0:x,this.n44=p===n?1:p},n11:1,n12:0,n13:0,n14:0,n21:0,n22:1,n23:0,n24:0,n31:0,n32:0,n33:1,n34:0,n41:0,n42:0,n43:0,n44:1,dispose:function(){return this.n11=null,this.n12=null,this.n13=null,this.n14=null,this.n21=null,this.n22=null,this.n23=null,this.n24=null,this.n31=null,this.n32=null,this.n33=null,this.n34=null,this.n41=null,this.n42=null,this.n43=null,this.n44=null,this},reset:function(){return this.n11=1,this.n12=0,this.n13=0,this.n14=0,this.n21=0,this.n22=1,this.n23=0,this.n24=0,this.n31=0,this.n32=0,this.n33=1,this.n34=0,this.n41=0,this.n42=0,this.n43=0,this.n44=1,this},translationMatrix:function(t,i,n){return this.n14=t,this.n24=i,this.n34=n,this},translationMatrixFromVector:function(t){var i=t.xyz;return this.n14=i[0],this.n24=i[1],this.n34=i[2],this},scaleMatrix:function(t,i,n){return this.n11=t,this.n22=i,this.n33=n,this},scaleMatrixFromVector:function(t){var i=t.xyz;return this.n11=i[0],this.n22=i[0],this.n33=i[0],this},rotationMatrix:function(t,i,n,s){var e=h(s),o=r(s),u=1-e,a=t*i*u,l=i*n*u,c=t*n*u,f=o*n,d=o*i,m=o*t;return this.n11=e+t*t*u,this.n12=-f+a,this.n13=d+c,this.n14=0,this.n21=f+a,this.n22=e+i*i*u,this.n23=-m+l,this.n24=0,this.n31=-d+c,this.n32=m+l,this.n33=e+n*n*u,this.n34=0,this},rotationMatrixFromVector:function(t,i){var n=t.xyz,s=n[0],e=n[1],o=n[2],u=h(i),a=r(i),l=1-u,c=s*e*l,f=e*o*l,d=s*o*l,m=a*o,x=a*e,p=a*s;return this.n11=u+s*s*l,this.n12=-m+c,this.n13=x+d,this.n14=0,this.n21=m+c,this.n22=u+e*e*l,this.n23=-p+f,this.n24=0,this.n31=-x+d,this.n32=p+f,this.n33=u+o*o*l,this.n34=0,this},multiply:function(t){return s(this,t),this},multiplyVector:function(t){var i=t.xyz,n=i[0],s=i[1],e=i[2];return i[0]=n*this.n11+s*this.n12+e*this.n13+this.n14,i[1]=n*this.n21+s*this.n22+e*this.n23+this.n24,i[2]=n*this.n31+s*this.n32+e*this.n33+this.n34,t}});e=o.multiplyVector=function(t,i){var n=i.xyz,s=n[0],e=n[1],r=n[2];return n[0]=s*t.n11+e*t.n12+r*t.n13+t.n14,n[1]=s*t.n21+e*t.n22+r*t.n23+t.n24,n[2]=s*t.n31+e*t.n32+r*t.n33+t.n34,i},s=o.calculateMultiply=function(t,i){var n=t.n11,s=i.n11,e=t.n21,r=i.n21,h=t.n31,o=i.n31,u=t.n12,a=i.n12,l=t.n22,c=i.n22,f=t.n32,d=i.n32,m=t.n13,x=i.n13,p=t.n23,y=i.n23,g=t.n33,v=i.n33,M=t.n14,w=i.n14,z=t.n24,A=i.n24,V=t.n34,b=i.n34;return t.n11=n*s+u*r+m*o,t.n12=n*a+u*c+m*d,t.n13=n*x+u*y+m*v,t.n14=n*w+u*A+m*b+M,t.n21=e*s+l*r+p*o,t.n22=e*a+l*c+p*d,t.n23=e*x+l*y+p*v,t.n24=e*w+l*A+p*b+z,t.n31=h*s+f*r+g*o,t.n32=h*a+f*c+g*d,t.n33=h*x+f*y+g*v,t.n34=h*w+f*A+g*b+V,t}}(n),function(t,n){var s=t.ModConstant,e=s.X,r=s.Y,h=s.Z,o=t.Vector3,u=t.VecArray;t.VertexProxy=i(Object,{constructor:function(t){this.xyz=new u([0,0,0]),this.original=new u([0,0,0]),this.ratio=new u([0,0,0]),n!==t&&null!==t&&!1!==t&&this.setVertex(t)},vertex:null,xyz:null,original:null,ratio:null,dispose:function(){return this.vertex=null,this.xyz=null,this.original=null,this.ratio=null,this},setVertex:function(t){return this.vertex=t,this},getRatioVector:function(){return new o(this.ratio)},getRatio:function(t){switch(t){case e:return this.ratio[0];case r:return this.ratio[1];case h:return this.ratio[2]}return-1},getOriginalValue:function(t){switch(t){case e:return this.original[0];case r:return this.original[1];case h:return this.original[2]}return 0},setRatios:function(t,i,s){return t=t===n?0:t,i=i===n?0:i,s=s===n?0:s,this.ratio=new u([t,i,s]),this},setOriginalPosition:function(t,i,s){return t=t===n?0:t,i=i===n?0:i,s=s===n?0:s,this.original=new u([t,i,s]),this},getXYZ:function(){return new u(this.xyz)},getXYZRef:function(){return this.xyz},getX:function(){return this.xyz[0]},getY:function(){return this.xyz[1]},getZ:function(){return this.xyz[2]},setXYZ:function(t){return t=new u(t),this},setXYZRef:function(t){return t=t,this},setX:function(t){return this.xyz[0]=t,this},setY:function(t){return this.xyz[1]=t,this},setZ:function(t){return this.xyz[2]=t,this},getValue:function(t){switch(t){case e:return this.getX();case r:return this.getY();case h:return this.getZ()}return 0},setValue:function(t,i){switch(t){case e:this.setX(i);break;case r:this.setY(i);break;case h:this.setZ(i)}return this},reset:function(){return this.setXYZ(this.original),this},collapse:function(){return this.original=this.getXYZ(),this},getVector:function(){return new o(this.getXYZ())},setVector:function(t){this.setXYZ(t.xyz)}})}(n),function(t){t.FaceProxy=i(Object,{constructor:function(){this.vertices=[]},vertices:null,dispose:function(){return this.vertices=null,this},addVertex:function(t){this.vertices.push(t)},getVertices:function(){return this.vertices}})}(n),function(t){var n=t.ModConstant,s=n.X,e=n.Y,r=n.Z,h=Math.min,o=Math.max;t.MeshProxy=i(Object,{constructor:function(t){this.maxX=null,this.maxY=null,this.maxZ=null,this.minX=null,this.minY=null,this.minZ=null,this.maxAxis=null,this.midAxis=null,this.minAxis=null,this.width=null,this.height=null,this.depth=null,this.vertices=[],this.faces=[],this.mesh=null,t&&this.setMesh(t)},maxX:null,maxY:null,maxZ:null,minX:null,minY:null,minZ:null,maxAxis:null,midAxis:null,minAxis:null,widht:null,height:null,depth:null,vertices:null,faces:null,mesh:null,dispose:function(){this.maxX=null,this.maxY=null,this.maxZ=null,this.minX=null,this.minY=null,this.minZ=null,this.maxAxis=null,this.midAxis=null,this.minAxis=null,this.widht=null,this.height=null,this.depth=null;var t,i;if(this.faces)for(i=this.faces.length,t=0;i>t;t++)this.faces[t].dispose();if(this.faces=null,this.vertices)for(i=this.vertices.length,t=0;i>t;t++)this.vertices[t].dispose();return this.vertices=null,this.mesh=null,this},setMesh:function(t){return this.mesh=t,this.vertices=[],this},getVertices:function(){return this.vertices},getFaces:function(){return this.faces},analyzeGeometry:function(){var t,i,n,u,a,l,c,f,d,m,x,p,y,g=this.vertices,v=g.length,M=v;for(v&&(t=g[0],i=t.getXYZ(),n=i[0],u=i[1],a=i[2],l=c=n,f=d=u,m=x=a);--M>=0;)t=g[M],i=t.getXYZ(),n=i[0],u=i[1],a=i[2],t.setOriginalPosition(n,u,a),l=h(l,n),f=h(f,u),m=h(m,a),c=o(c,n),d=o(d,u),x=o(x,a);p=c-l,y=d-f,depth=x-m,this.width=p,this.height=y,this.depth=depth,this.minX=l,this.maxX=c,this.minY=f,this.maxY=d,this.minZ=m,this.maxZ=x;var w=o(p,y,depth),z=h(p,y,depth);for(w==p&&z==y?(this.minAxis=e,this.midAxis=r,this.maxAxis=s):w==p&&z==depth?(this.minAxis=r,this.midAxis=e,this.maxAxis=s):w==y&&z==p?(this.minAxis=s,this.midAxis=r,this.maxAxis=e):w==y&&z==depth?(this.minAxis=r,this.midAxis=s,this.maxAxis=e):w==depth&&z==p?(this.minAxis=s,this.midAxis=e,this.maxAxis=r):w==depth&&z==y&&(this.minAxis=e,this.midAxis=s,this.maxAxis=r),M=v;--M>=0;)t=g[M],i=t.getXYZ(),t.setRatios((i[0]-l)/p,(i[1]-f)/y,(i[2]-m)/depth);return this},resetGeometry:function(){for(var t=this.vertices,i=t.length;--i>=0;)t[i].reset();return this.update(),this},collapseGeometry:function(){for(var t=this.vertices,i=t.length;--i>=0;)t[i].collapse();return this.update(),this.analyzeGeometry(),this},getMin:function(t){switch(t){case s:return this.minX;case e:return this.minY;case r:return this.minZ}return-1},getMax:function(t){switch(t){case s:return this.maxX;case e:return this.maxY;case r:return this.maxZ}return-1},getSize:function(t){switch(t){case s:return this.width;case e:return this.height;case r:return this.depth}return-1},update:function(){return this},postApply:function(){return this},updateMeshPosition:function(){return this}})}(n),function(t,n){var s=0;t.Modifier=i(Object,{constructor:function(t){this.id=++s,this.name="Generic Modifier",this.mod=t||null,this.enabled=!0},id:null,name:null,mod:null,enabled:!0,dispose:function(){return this.mod=null,this.name=null,this},enable:function(t){return n!==t?(this.enabled=!!t,this):this.enabled},setModifiable:function(t){return this.mod=t,this},getVertices:function(){return this.mod.getVertices()},apply:function(){return this}})}(n),function(t){t.Library3d=i(Object,{constructor:function(){this.id="",this.meshClass=null,this.vertexClass=null},id:"",meshClass:null,vertexClass:null})}(n),function(t){t.PluginFactory={getMeshProxy:function(t){var i=t.meshClass;return i?new i:null}}}(n),function(t){var n=t.PluginFactory.getMeshProxy;t.ModifierStack=i(Object,{constructor:function(t,i){this.baseMesh=null,this.stack=[],this.lib3d=t,this.baseMesh=n(t),this.baseMesh.setMesh(i),this.baseMesh.analyzeGeometry()},lib3d:null,baseMesh:null,stack:null,dispose:function(t){if(this.lib3d=null,this.baseMesh.dispose(),this.baseMesh=null,t)for(;this.stack.length;)this.stack.pop().dispose();return this.stack=null,this},addModifier:function(t){return t.setModifiable(this.baseMesh),this.stack.push(t),this},apply:function(){var t=this.stack,i=t.length,n=this.baseMesh,s=0;for(n.resetGeometry();i>s;)t[s].enabled&&t[s].apply(),s++;return n.update(),this},collapse:function(){return this.apply(),this.baseMesh.collapseGeometry(),this.stack.length=0,this},clear:function(){return this.stack.length=0,this},getMeshInfo:function(){return this.baseMesh}})}(n),function(t){var n=t.Vector3;t.Pivot=i(t.Modifier,{constructor:function(t,i,s){this.$super("constructor"),this.name="Pivot",this.pivot=new n([t,i,s])},pivot:null,dispose:function(){return this.pivot.dispose(),this.pivot=null,this.$super("dispose"),this},setMeshCenter:function(){var t=this.mod;return this.pivot=new n(-(t.minX+.5*t.width),-(t.minY+.5*t.height),-(t.minZ+.5*t.depth)),this},apply:function(){for(var t,i=this.mod.getVertices(),n=i.length,s=this.pivot;--n>=0;)t=i[n],t.setVector(t.getVector().addSelf(s));return this.mod.updateMeshPosition(s.negate()),this}})}(n),function(t,n){var s=t.ModConstant.NONE,e=t.ModConstant.LEFT,r=t.ModConstant.RIGHT,h=t.Matrix,o=Math.atan,u=(Math.atan2,Math.sin),a=Math.cos,l=t.Constants.PI,c=t.Constants.halfPI,f=t.Constants.doublePI,d=t.Point;t.Bend=i(t.Modifier,{constructor:function(t,i,e){this.$super("constructor"),this.name="Bend",this.constraint=s,this.max=0,this.min=0,this.mid=0,this.width=0,this.height=0,this.origin=0,this.m1=null,this.m2=null,this.diagAngle=0,this.switchAxes=!1,this.force=t!==n?t:0,this.offset=i!==n?i:0,e!==n?this.setAngle(e):this.setAngle(0)},force:0,offset:0,angle:0,diagAngle:0,constraint:s,max:0,min:0,mid:0,width:0,height:0,origin:0,m1:null,m2:null,switchAxes:!1,dispose:function(){return this.force=null,this.offset=null,this.angle=null,this.diagAngle=null,this.constraint=null,this.max=null,this.min=null,this.mid=null,this.width=null,this.height=null,this.origin=null,this.m1&&this.m1.dispose(),this.m2&&this.m2.dispose(),this.m1=null,this.m2=null,this.switchAxes=null,this.$super("dispose"),this},setAngle:function(t){return this.angle=t,this.m1=(new h).rotate(t),this.m2=(new h).rotate(-t),this},setModifiable:function(t){return this.$super("setModifiable",t),this.max=this.switchAxes?this.mod.midAxis:this.mod.maxAxis,this.min=this.mod.minAxis,this.mid=this.switchAxes?this.mod.maxAxis:this.mod.midAxis,this.width=this.mod.getSize(this.max),this.height=this.mod.getSize(this.mid),this.origin=this.mod.getMin(this.max),this.diagAngle=o(this.width/this.height),this},apply:function(){if(!this.force)return this;for(var t,i,n,s,h,o,m,x,p,y,g=this.mod.getVertices(),v=g.length,M=this.constraint,w=this.width,z=this.offset,A=this.origin,V=this.force,b=this.max,X=this.min,Z=this.mid,Y=this.m1,P=this.m2,S=A+w*z,I=w/l/V,R=f*(w/(I*f)),C=1/w;--v>=0;)t=g[v],i=t.getValue(b),n=t.getValue(Z),s=t.getValue(X),h=Y.transformPointSelf(new d(i,n)),i=h.x,n=h.y,o=(i-A)*C,M==e&&z>=o||M==r&&o>=z||(m=c-R*z+R*o,x=u(m)*(I+s),p=a(m)*(I+s),s=x-I,i=S-p),y=P.transformPointSelf(new d(i,n)),i=y.x,n=y.y,t.setValue(b,i),t.setValue(Z,n),t.setValue(X,s);return this}})}(n),function(t){var n=t.Vector3,s=Math.max,e=Math.exp;t.Bloat=i(t.Modifier,{constructor:function(){this.$super("constructor"),this.name="Bloat",this.radius=0,this.a=.01,this.center=n.ZERO()},center:null,radius:0,a:.01,dispose:function(){return this.center.dispose(),this.center=null,this.radius=null,this.a=null,this.$super("dispose"),this},setRadius:function(t){return this.radius=s(0,t),this},setA:function(t){return this.a=s(0,t),this},apply:function(){for(var t,i,n,s=this.mod.getVertices(),r=s.length,h=this.center,o=this.radius,u=this.a;--r>=0;)t=s[r],n=t.getVector().subtractSelf(h),i=n.getMagnitude(),n.setMagnitude(i+o*e(-i*u)),t.setVector(n.addSelf(h));return this}})}(n),function(t,n){var s=t.Vector3,e=t.Matrix4;t.Twist=i(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Twist",this.vector=new s([0,1,0]),this.angle=t!==n?t:0,this.center=s.ZERO(),this.mat1=new e,this.mat2=new e},vector:null,angle:0,center:null,mat1:null,mat2:null,dispose:function(){return this.vector.dispose(),this.vector=null,this.angle=null,this.center.dispose(),this.center=null,this.mat1.dispose(),this.mat2.dispose(),this.mat1=null,this.mat2=null,this.$super("dispose"),this},apply:function(){for(var t,i,n,e=this.mod,r=e.getVertices(),h=r.length,o=this.vector.normalizeSelf(),u=this.angle,a=this.center,l=new s([.5*e.maxX,.5*e.maxY,.5*e.maxZ]),c=1/l.getMagnitude(),f=c*u,d=-s.dot(o,a);--h>=0;)t=r[h],n=t.getVector(),i=s.dot(n,o)+d,t.setVector(this.twistPoint(n,o,i*f));return this},twistPoint:function(t,i,n){var e=this.mat1.reset().translationMatrixFromVector(t),r=this.mat2.reset().rotationMatrixFromVector(i,n);return r.multiply(e),new s([r.n14,r.n24,r.n34])}})}(n),function(t,n){var s=Math.abs,e=Math.pow,r=(t.XMath.sign,t.ModConstant),h=r.NONE,o=r.LEFT,u=r.RIGHT,a=r.X,l=r.Y,c=r.Z;t.Skew=i(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Skew",this.force=t!==n?t:0,this.offset=.5,this.constraint=h,this.power=1,this.falloff=1,this.inverseFalloff=!1,this.oneSide=!1,this.swapAxes=!1,this.skewAxis=0},force:0,skewAxis:0,offset:.5,constraint:h,power:1,falloff:1,inverseFalloff:!1,oneSide:!1,swapAxes:!1,dispose:function(){return this.force=null,this.skewAxis=null,this.offset=null,this.constraint=null,this.power=null,this.falloff=null,this.inverseFalloff=null,this.oneSide=null,this.swapAxes=null,this.$super("dispose"),this},setModifiable:function(t){return this.$super("setModifiable",t),this.skewAxis=this.skewAxis||this.mod.maxAxis,this},apply:function(){for(var t,i,n,r,h,a,l,c,f=this.mod.getVertices(),d=f.length,m=this.constraint,x=this.skewAxis,p=this.offset,y=this.oneSide,g=this.inverseFalloff,v=this.falloff,M=1-v,w=this.power,z=this.force,A=this.getDisplaceAxis();--d>=0;)t=f[d],l=t.getRatio(x),m==o&&p>=l||m==u&&l>p||(i=l-p,y&&(i=s(i)),n=t.getRatio(A),g&&(n=1-n),r=v+n*M,c=0>i?-1:1,h=e(s(i),w)*c,a=t.getValue(A)+z*h*r,t.setValue(A,a));return this},getDisplaceAxis:function(){var t=this.skewAxis,i=this.swapAxes;switch(t){case a:return i?c:l;case l:return i?c:a;case c:return i?l:a}}})}(n),function(t,n){var s=t.Vector3,e=t.Matrix4,r=Math.pow;t.Taper=i(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Taper",this.vector=new s([1,0,1]),this.vector2=new s([0,1,0]),this.force=t!==n?t:0,this.power=1},force:0,power:1,vector:null,vector2:null,dispose:function(){return this.vector.dispose(),this.vector2.dispose(),this.vector=null,this.vector2=null,this.force=null,this.power=null,this.$super("dispose"),this},apply:function(){var t,i,n,s,h,o,u=this.mod.getVertices(),a=u.length,l=this.vector,c=this.vector2,f=this.force,d=this.power;for(s=new e;--a>=0;)t=u[a],i=t.getRatioVector().multiply(c),n=1!=d?f*r(i.getMagnitude(),d):f*i.getMagnitude(),o=l.xyz,s.reset().scaleMatrix(1+n*o[0],1+n*o[1],1+n*o[2]),h=t.getVector(),t.setVector(s.multiplyVector(h));return this}})}(n),function(t){var n=t.Constants.invPI,s=t.Constants.doublePI,e=t.Vector3,r=t.Matrix4;t.Wheel=i(t.Modifier,{constructor:function(){this.$super("constructor"),this.name="Wheel",this.speed=0,this.turn=0,this.roll=0,this.radius=0,this.steerVector=new e([0,1,0]),this.rollVector=new e([0,0,1])},speed:0,turn:0,roll:0,radius:0,steerVector:null,rollVector:null,dispose:function(){return this.speed=null,this.turn=null,this.roll=null,this.radius=null,this.steerVector.dispose(),this.rollVector.dispose(),this.steerVector=null,this.rollVector=null,this.$super("dispose"),this},setModifiable:function(t){return this.$super("setModifiable",t),this.radius=.5*this.mod.width,this},apply:function(){var t,i,n=this.mod.getVertices(),s=n.length,e=this.steerVector,h=this.turn,o=this.rollVector,u=this.roll,a=null,l=null,c=null;for(this.roll+=this.speed,h?(l=(new r).rotationMatrixFromVector(e,h),c=l.multiplyVector(o.clone()),a=(new r).rotationMatrixFromVector(c,u)):a=(new r).rotationMatrixFrom(o,u);--s>=0;)t=n[s],i=t.getVector(),l&&l.multiplyVector(i),setVector(a.multiplyVector(i));return this},getStep:function(){return this.radius*this.speed*n},getPerimeter:function(){return this.radius*s}})}(n),function(t,n){var s=t.Vector3,e=t.Range,r=t.Matrix4;t.Break=i(t.Modifier,{constructor:function(t,i){this.$super("constructor"),this.name="Break",this.bv=new s([0,1,0]),this.range=new e(0,1),this.offset=t!==n?t:0,this.angle=i!==n?i:0},bv:null,range:null,offset:0,angle:0,dispose:function(){return this.bv.dispose(),this.bv=null,this.range.dispose(),this.range=null,this.offset=null,this.angle=null,this.$super("dispose"),this},apply:function(){var t,i,n,e,h,o=this.mod,u=o.getVertices(),a=u.length,l=this.offset,c=this.range,f=this.angle,d=this.bv,m=d.xyz;for(t=new s([0,0,-(o.minZ+o.depth*l)]),i=t.negate(),h=(new r).rotationMatrix(m[0],m[1],m[2],f);--a>=0;)n=u[a],e=n.getVector().addSelf(t),e.xyz[2]>=0&&c.isIn(n.ratio[1])&&h.multiplyVector(e),n.setVector(e.addSelf(i));return this}})}(n),function(t,n){var s=t.ModConstant.NONE,e=t.ModConstant.X,r=t.ModConstant.Y,h=t.ModConstant.Z,o=(t.VecArray,Math.random);t.Noise=i(t.Modifier,{constructor:function(t){this.$super("constructor"),this.name="Noise",this.axc=s,this.start=0,this.end=0,this.force=t!==n?t:0},force:0,axc:s,start:0,end:1,dispose:function(){return this.force=null,this.axc=null,this.start=null,this.end=null,this.$super("dispose"),this},constraintAxes:function(t){return this.axc=t,this},setFalloff:function(t,i){return this.start=t!==n?t:0,this.end=i!==n?i:1,this},apply:function(){for(var t,i,n,s,u,a=this.mod,l=this.axc,c=this.start,f=this.end,d=a.getVertices(),m=d.length,x=this.force,p=.5*x;--m>=0;)t=d[m],i=o()*x-p,n=t.getRatio(a.maxAxis),f>c?c>n?n=0:n>f&&(n=1):c>f?(n=1-n,n>c?n=0:f>n&&(n=1)):n=1,s=i*n,u=t.getXYZ(),t.setXYZ([u[0]+(l&e?0:s),u[1]+(l&r?0:s),u[2]+(l&h?0:s)]);return this}})}(n),function(t){var n=t.ModConstant,s=n.X,e=n.Y,r=n.Z,h=t.Vector3,o=t.VecArray,u=t.VertexThree=i(t.VertexProxy,{constructor:function(t,i){this.mesh=t,this.$super("constructor",i)},mesh:null,dispose:function(){return this.mesh=null,this.$super("dispose"),this},setVertex:function(t){return this.vertex=t,this.original=new o([t.x,t.y,t.z]),this.xyz=new o(this.original),this},getXYZ:function(){var t=this.vertex;return new o([t.x,t.y,t.z])},getX:function(){return this.vertex.x},getY:function(){return this.vertex.y},getZ:function(){return this.vertex.z},setXYZ:function(t){var i=this.vertex;return this.mesh.geometry,i.x=t[0],i.y=t[1],i.z=t[2],this},setX:function(t){var i=this.vertex;return i.x=t,this},setY:function(t){var i=this.vertex;return i.y=t,this},setZ:function(t){var i=this.vertex;return i.z=t,this},reset:function(){var t=this.vertex,i=(this.mesh.geometry,this.original);return t.x=i[0],t.y=i[1],t.z=i[2],this},collapse:function(){var t=this.vertex;return this.original=new o([t.x,t.y,t.z]),this},getValue:function(t){var i=this.vertex;switch(t){case s:return i.x;case e:return i.y;case r:return i.z}return 0},setValue:function(t,i){var n=this.vertex,h=!1;switch(t){case s:n.x=i,h=!0;break;case e:n.y=i,h=!0;break;case r:n.z=i,h=!0}return this},setVector:function(t){var i=this.vertex,n=t.xyz;return this.mesh.geometry,i.x=n[0],i.y=n[1],i.z=n[2],this},getVector:function(){var t=this.vertex;return new h([t.x,t.y,t.z])}});u.prototype.getXYZRef=u.prototype.getXYZ,u.prototype.setXYZRef=u.prototype.setXYZ}(n),function(t){var n=t.VertexThree;t.FaceProxy,t.MeshThree=i(t.MeshProxy,{constructor:function(t){this.$super("constructor",t)},setMesh:function(t){this.$super("setMesh",t);var i,s=0,t=this.mesh,e=this.vertices,r=t.geometry.vertices,h=r.length,o=t.geometry.faces;for(o.length,s=0;h>s;)i=new n(t,r[s]),e.push(i),s++;return this.faces=null,this},update:function(){var t=this.mesh.geometry;return t.verticesNeedUpdate=!0,t.normalsNeedUpdate=!0,t.buffersNeedUpdate=!0,t.dynamic=!0,this},updateMeshPosition:function(t){var i=this.mesh.position,n=t.xyz;return i.x+=n[0],i.y+=n[1],i.z+=n[2],this}})}(n),function(t){var n=i(t.Library3d,{constructor:function(){this.id="Three.js",this.meshClass=t.MeshThree,this.vertexClass=t.VertexThree}});t.LibraryThree=new n}(n),n});